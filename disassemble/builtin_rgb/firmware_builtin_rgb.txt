POK3R RGB Firmware Builtin Disassembly:

vector_table:
     0x0:   0x20000740  ; Stack Pointer (stack_max)
       4:   0x119       ; PC Reset      (reset)
       8:   0x125       ; NMI           (generic_fault)
       c:   0x125       ; Hard Fault    (generic_fault)
      10:   0x125       ; MCU Fault     (generic_fault)
      14:   0x125       ; Bus Fault     (generic_fault)
      18:   0x125       ; Usage Fault   (generic_fault)

.text:

entry:
      1c:   f8df d00c   ldr.w sp, [pc, #12]    ; 0x2c
      20:   f000 f832   bl 0x88
      24:   4800        ldr r0, [pc, #0]    ; (0x28)
      26:   4700        bx r0

    0x28:   0x1ea5      ; main
    0x2c:   0x20000740  ; stack_max

load_jump_fw:
    ; r0 = vector address
    0x30:   6801        ldr r1, [r0, #0]
      32:   468d        mov sp, r1
      34:   6841        ldr r1, [r0, #4]
      36:   4708        bx r1

    0x38:   60c1        str r1, [r0, #12]
      3a:   4770        bx lr

    0x3c:   0x10f      ; SySTick           (systick_intr)

memcpy:
    ; r0 = dest
    ; r1 = src
    ; r2 = length (in bytes)
    0x40:   ea40 0301   orr.w r3, r0, r1
      44:   079b        lsls r3, r3, #30
      46:   d003        beq.n 0x50
      48:   e009        b.n 0x5e
      4a:   c908        ldmia r1!, {r3}
      4c:   1f12        subs r2, r2, #4
      4e:   c008        stmia r0!, {r3}
      50:   2a04        cmp r2, #4
      52:   d2fa        bcs.n 0x4a
      54:   e003        b.n 0x5e
      56:   f811 3b01   ldrb.w r3, [r1], #1
      5a:   f800 3b01   strb.w r3, [r0], #1
      5e:   1e52        subs r2, r2, #1
      60:   d2f9        bcs.n 0x56
      62:   4770        bx lr

mem_set:
    ; r0 = dest
    ; r1 = len
    ; r2 = byte
    0x64:   b2d2        uxtb r2, r2
      66:   e001        b.n 0x6c

      68:   f800 2b01   strb.w r2, [r0], #1
      6c:   1e49        subs r1, r1, #1
      6e:   d2fb        bcs.n 0x68
      70:   4770        bx lr

mem_zero:
    ; r0 = dest
    ; r1 = len
    0x72:   2200        movs r2, #0
      74:   e7f6        b.n 0x64

mem_set2:
    ; r0 = dest
    ; r1 = byte
    ; r2 = len
    0x76:   b510        push {r4, lr}
      78:   4613        mov r3, r2
      7a:   460a        mov r2, r1
      7c:   4604        mov r4, r0
      7e:   4619        mov r1, r3
      80:   f7ff fff0   bl 0x64
      84:   4620        mov r0, r4
      86:   bd10        pop {r4, pc}

sram_init:
    0x88:   4c06        ldr r4, [pc, #24]    ; (0xa4)
      8a:   4d07        ldr r5, [pc, #28]    ; (0xa8)
      8c:   e006        b.n 0x9c

      8e:   68e0        ldr r0, [r4, #12]
      90:   f040 0301   orr.w r3, r0, #1
      94:   e894 0007   ldmia.w r4, {r0, r1, r2}
      98:   4798        blx r3
      9a:   3410        adds r4, #16

      9c:   42ac        cmp r4, r5
      9e:   d3f6        bcc.n 0x8e
      a0:   f7ff ffc0   bl 0x24

    0xa4:   0x2230
    0xa8:   0x2250

    0xac:   b510        push {r4, lr}
      ae:   2200        movs r2, #0
      b0:   2807        cmp r0, #7
      b2:   d902        bls.n 0xba
      b4:   2201        movs r2, #1
      b6:   3808        subs r0, #8
      b8:   b2c0        uxtb r0, r0
      ba:   0093        lsls r3, r2, #2
      bc:   4a05        ldr r2, [pc, #20]    ; (0xd4)
      be:   441a        add r2, r3
      c0:   6813        ldr r3, [r2, #0]
      c2:   0080        lsls r0, r0, #2
      c4:   240f        movs r4, #15
      c6:   4084        lsls r4, r0
      c8:   43a3        bics r3, r4
      ca:   4081        lsls r1, r0
      cc:   4319        orrs r1, r3
      ce:   6011        str r1, [r2, #0]
      d0:   bd10        pop {r4, pc}
      d2:   0000        movs r0, r0

      d4:   0x40022000

bftm_set_counter:
    0xd8:   6081        str r1, [r0, #8]
      da:   4770        bx lr

      dc:   6281        str r1, [r0, #40]    ; 0x28
      de:   4770        bx lr

      e0:   6241        str r1, [r0, #36]    ; 0x24
      e2:   4770        bx lr

    0xe4:   0x135       ; 41 BFTM0          (bftm0_intr)
    0xe8:   0x165       ; 42 BFTM1          (bftm1_intr)
    0xec:   0x127       ; 43 I2C0           (generic_intr)
    0xf0:   0x127       ; 44 I2C1           (generic_intr)

bftm_clear:
    ; r0 = bftm base reg
    0xf4:   6841        ldr r1, [r0, #4]
      f6:   f021 0101   bic.w r1, r1, #1
      fa:   6041        str r1, [r0, #4]
      fc:   f3bf 8f4f   dsb sy
     100:   4770        bx lr

     102:   eb00 0080   add.w r0, r0, r0, lsl #2
     106:   0080        lsls r0, r0, #2
     108:   1e40        subs r0, r0, #1
     10a:   d2fd        bcs.n 0x108
     10c:   4770        bx lr
     10e:   4770        bx lr
     110:   f001 ba04   b.w 0x151c

   0x114:   0x15e9      ; 53 USB            (usb_intr)

reset:
   0x118:   4803        ldr r0, [pc, #12]   ; (0x128)
     11a:   4780        blx r0              ; call watchdog_init
     11c:   4803        ldr r0, [pc, #12]   ; (0x12c)
     11e:   4780        blx r0              ; call clock_init
     120:   4803        ldr r0, [pc, #12]   ; (0x130)
     122:   4700        bx r0               ; jump entry

generic_fault:
   0x124:   e7fe        b.n 0x124

generic_intr;
   0x126:   e7fe        b.n 0x126

   0x128:   0x15f5      ; watchdog_init
   0x12c:   0xf8d       ; clock_init
   0x130:   0x1d        ; entry

     134:   4809        ldr r0, [pc, #36]    ; (0x15c)
     136:   b510        push {r4, lr}
     138:   6801        ldr r1, [r0, #0]
     13a:   b111        cbz r1, 0x142
     13c:   6801        ldr r1, [r0, #0]
     13e:   1e49        subs r1, r1, #1
     140:   6001        str r1, [r0, #0]
     142:   6841        ldr r1, [r0, #4]
     144:   b111        cbz r1, 0x14c
     146:   6841        ldr r1, [r0, #4]
     148:   1e49        subs r1, r1, #1
     14a:   6041        str r1, [r0, #4]
     14c:   4804        ldr r0, [pc, #16]    ; (0x160)
     14e:   f7ff ffd1   bl 0xf4                 ; call bftm_clear
     152:   e8bd 4010   ldmia.w sp!, {r4, lr}
     156:   f000 bd21   b.w 0xb9c
     15a:   0000        movs r0, r0
     15c:   02ec        lsls r4, r5, #11
     15e:   2000        movs r0, #0
     160:   6000        str r0, [r0, #0]
     162:   4007        ands r7, r0
     164:   b510        push {r4, lr}
     166:   4813        ldr r0, [pc, #76]    ; (0x1b4)
     168:   f7ff ffc4   bl 0xf4             ; call bftm_clear
     16c:   4c12        ldr r4, [pc, #72]    ; (0x1b8)
     16e:   6860        ldr r0, [r4, #4]
     170:   8881        ldrh r1, [r0, #4]
     172:   6800        ldr r0, [r0, #0]
     174:   b289        uxth r1, r1
     176:   f7ff ffb3   bl 0xe0
     17a:   200a        movs r0, #10
     17c:   f7ff ffc1   bl 0x102
     180:   2002        movs r0, #2
     182:   f001 fb5f   bl 0x1844
     186:   490d        ldr r1, [pc, #52]    ; (0x1bc)
     188:   f44f 4000   mov.w r0, #32768    ; 0x8000
     18c:   6248        str r0, [r1, #36]    ; 0x24
     18e:   480c        ldr r0, [pc, #48]    ; (0x1c0)
     190:   7861        ldrb r1, [r4, #1]
     192:   eb00 00c1   add.w r0, r0, r1, lsl #3
     196:   6060        str r0, [r4, #4]
     198:   8881        ldrh r1, [r0, #4]
     19a:   6800        ldr r0, [r0, #0]
     19c:   b289        uxth r1, r1
     19e:   f7ff ff9d   bl 0xdc
     1a2:   7860        ldrb r0, [r4, #1]
     1a4:   1c40        adds r0, r0, #1
     1a6:   f000 0007   and.w r0, r0, #7
     1aa:   7060        strb r0, [r4, #1]
     1ac:   e8bd 4010   ldmia.w sp!, {r4, lr}
     1b0:   f000 bea6   b.w 0xf00
     1b4:   7000        strb r0, [r0, #0]
     1b6:   4007        ands r7, r0
     1b8:   0010        movs r0, r2
     1ba:   2000        movs r0, #0
     1bc:   0000        movs r0, r0
     1be:   400b        ands r3, r1
     1c0:   2074        movs r0, #116    ; 0x74
     1c2:   0000        movs r0, r0

bftm_set_cen:
    ; r0 = bftm base
    ; r1 = 0/1
   0x1c4:   2900        cmp r1, #0
     1c6:   6801        ldr r1, [r0, #0]
     1c8:   d002        beq.n 0x1d0
     1ca:   f041 0104   orr.w r1, r1, #4
     1ce:   e001        b.n 0x1d4
     1d0:   f021 0104   bic.w r1, r1, #4
     1d4:   6001        str r1, [r0, #0]
     1d6:   4770        bx lr

bftm_set_mien:
    ; r0 = bftm base
    ; r1 = 0/1
   0x1d8:   2900        cmp r1, #0
     1da:   6801        ldr r1, [r0, #0]
     1dc:   d002        beq.n 0x1e4
     1de:   f041 0101   orr.w r1, r1, #1
     1e2:   e001        b.n 0x1e8
   0x1e4:   f021 0101   bic.w r1, r1, #1
   0x1e8:   6001        str r1, [r0, #0]
     1ea:   4770        bx lr

   0x1ec:   00c0        lsls r0, r0, #3
     1ee:   08cb        lsrs r3, r1, #3
     1f0:   eb00 0083   add.w r0, r0, r3, lsl #2
     1f4:   4b06        ldr r3, [pc, #24]    ; (0x210)
     1f6:   b510        push {r4, lr}
     1f8:   4418        add r0, r3
     1fa:   0749        lsls r1, r1, #29
     1fc:   6803        ldr r3, [r0, #0]
     1fe:   0ec9        lsrs r1, r1, #27
     200:   240f        movs r4, #15
     202:   408c        lsls r4, r1
     204:   43a3        bics r3, r4
     206:   408a        lsls r2, r1
     208:   4313        orrs r3, r2
     20a:   6003        str r3, [r0, #0]
     20c:   bd10        pop {r4, pc}
     20e:   0000

   0x210:   0x40022020

     214:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
     218:   f44f 4580   mov.w r5, #16384    ; 0x4000
     21c:   2400        movs r4, #0
     21e:   00a8        lsls r0, r5, #2
     220:   4622        mov r2, r4
     222:   4680        mov r8, r0
     224:   2301        movs r3, #1
     226:   4629        mov r1, r5
     228:   f000 f850   bl 0x2cc                ; call ckcu_clocks_enable
     22c:   4e25        ldr r6, [pc, #148]    ; (0x2c4)
     22e:   2200        movs r2, #0
     230:   4629        mov r1, r5
     232:   4630        mov r0, r6
     234:   f000 f8b4   bl 0x3a0
     238:   006f        lsls r7, r5, #1
     23a:   2200        movs r2, #0
     23c:   4639        mov r1, r7
     23e:   4630        mov r0, r6
     240:   f000 f8ae   bl 0x3a0
     244:   2202        movs r2, #2
     246:   4629        mov r1, r5
     248:   4630        mov r0, r6
     24a:   f000 f8b9   bl 0x3c0
     24e:   2202        movs r2, #2
     250:   4639        mov r1, r7
     252:   4630        mov r0, r6
     254:   f000 f8b4   bl 0x3c0
     258:   10ed        asrs r5, r5, #3
     25a:   2200        movs r2, #0
     25c:   4629        mov r1, r5
     25e:   4630        mov r0, r6
     260:   f000 f89e   bl 0x3a0
     264:   2202        movs r2, #2
     266:   4629        mov r1, r5
     268:   4630        mov r0, r6
     26a:   f000 f8a9   bl 0x3c0
     26e:   2201        movs r2, #1
     270:   210b        movs r1, #11
     272:   2000        movs r0, #0
     274:   f7ff ffba   bl 0x1ec
     278:   2201        movs r2, #1
     27a:   210d        movs r1, #13
     27c:   2002        movs r0, #2
     27e:   f7ff ffb5   bl 0x1ec
     282:   2201        movs r2, #1
     284:   210e        movs r1, #14
     286:   2002        movs r0, #2
     288:   f7ff ffb0   bl 0x1ec
     28c:   2201        movs r2, #1
     28e:   210f        movs r1, #15
     290:   2002        movs r0, #2
     292:   f7ff ffab   bl 0x1ec
     296:   480c        ldr r0, [pc, #48]    ; (0x2c8)
     298:   6840        ldr r0, [r0, #4]
     29a:   0540        lsls r0, r0, #21
     29c:   d409        bmi.n 0x2b2
     29e:   2201        movs r2, #1
     2a0:   210e        movs r1, #14
     2a2:   4610        mov r0, r2
     2a4:   f7ff ffa2   bl 0x1ec
     2a8:   2201        movs r2, #1
     2aa:   210f        movs r1, #15
     2ac:   4610        mov r0, r2
     2ae:   f7ff ff9d   bl 0x1ec
     2b2:   4621        mov r1, r4
     2b4:   2300        movs r3, #0
     2b6:   4622        mov r2, r4
     2b8:   4640        mov r0, r8
     2ba:   f000 f807   bl 0x2cc                ; call ckcu_clocks_enable
     2be:   2001        movs r0, #1
     2c0:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
     2c4:   0000        movs r0, r0
     2c6:   400b        ands r3, r1

     2c8:   0x40088000

ckcu_clocks_enable:
    ; Enable AHB, APB0, or APB1 clocks
    ; r0 = AHB clock mask
    ; r1 = APB0 clock mask
    ; r2 = APB1 clock mask
    ; r3 = enable/disable
   0x2cc:   b5f0        push {r4, r5, r6, r7, lr}
     2ce:   4f07        ldr r7, [pc, #28]    ; (0x2ec)
     2d0:   6a7c        ldr r4, [r7, #36]    ; 0x24
     2d2:   6afd        ldr r5, [r7, #44]    ; 0x2c
     2d4:   6b3e        ldr r6, [r7, #48]    ; 0x30
     2d6:   4384        bics r4, r0
     2d8:   438d        bics r5, r1
     2da:   4396        bics r6, r2
     2dc:   b113        cbz r3, 0x2e4
     2de:   4304        orrs r4, r0
     2e0:   430d        orrs r5, r1
     2e2:   4316        orrs r6, r2
     2e4:   627c        str r4, [r7, #36]    ; 0x24
     2e6:   62fd        str r5, [r7, #44]    ; 0x2c
     2e8:   633e        str r6, [r7, #48]    ; 0x30
     2ea:   bdf0        pop {r4, r5, r6, r7, pc}

     2ec:   0x40088000  ; CKCU

ckcu_set_usb_prescaler:
    ; r0 = usb clock prescaler 0/1/2
   0x2f0:   4903        ldr r1, [pc, #12]    ; (0x300)
     2f2:   680a        ldr r2, [r1, #0]
     2f4:   f422 0240   bic.w r2, r2, #12582912    ; 0xc00000
     2f8:   ea42 5080   orr.w r0, r2, r0, lsl #22
     2fc:   6008        str r0, [r1, #0]
     2fe:   4770        bx lr

     300:   0x40088000  ; CKCU

flash_page_erase:
    ; r0 = page address
   0x304:   4902        ldr r1, [pc, #8]    ; (0x310)
     306:   6008        str r0, [r1, #0]
     308:   2008        movs r0, #8
     30a:   60c8        str r0, [r1, #12]
     30c:   f000 b802   b.w 0x314

     310:   0x40080000  ; FMC

flash_commit:
   0x314:   4911        ldr r1, [pc, #68]   ; (0x35c) FMC
     316:   4810        ldr r0, [pc, #64]   ; (0x358) timeout

     318:   694a        ldr r2, [r1, #20]
     31a:   f042 0202   orr.w r2, r2, #2    ; OIER |= 2
     31e:   614a        str r2, [r1, #20]

     320:   2214        movs r2, #20
     322:   610a        str r2, [r1, #16]   ; commit
     324:   e004        b.n 0x330

    ; wait loop
   0x326:   690a        ldr r2, [r1, #16]   ; OPCR
     328:   f3c2 0281   ubfx r2, r2, #2, #2
     32c:   2a03        cmp r2, #3
     32e:   d001        beq.n 0x334
   0x330:   1e40        subs r0, r0, #1
     332:   d2f8        bcs.n 0x326

   0x334:   698a        ldr r2, [r1, #24]   ; OISR

     336:   698b        ldr r3, [r1, #24]
     338:   f023 0302   bic.w r3, r3, #2
     33c:   618b        str r3, [r1, #24]

    ; check protected error flag
     33e:   0391        lsls r1, r2, #14
     340:   d501        bpl.n 0x346

    ; error: page protected
     342:   2002        movs r0, #2
     344:   4770        bx lr

   0x346:   0791        lsls r1, r2, #30
     348:   d501        bpl.n 0x34e

    ; error: invalid address
     34a:   2001        movs r0, #1
     34c:   4770        bx lr

    ; ok
   0x34e:   b108        cbz r0, 0x354
     350:   2000        movs r0, #0
     352:   4770        bx lr

     ; error: timeout
   0x354:   2003        movs r0, #3
     356:   4770        bx lr

   0x358:   0xfffff     ; timeout
   0x35c:   0x40080000  ; FMC

     360:   f000 0207   and.w r2, r0, #7
     364:   b510        push {r4, lr}
     366:   4b09        ldr r3, [pc, #36]    ; (0x38c)
     368:   08c0        lsrs r0, r0, #3
     36a:   eb03 1482   add.w r4, r3, r2, lsl #6
     36e:   0040        lsls r0, r0, #1
     370:   2203        movs r2, #3
     372:   e007        b.n 0x384
     374:   f824 1010   strh.w r1, [r4, r0, lsl #1]
     378:   3012        adds r0, #18
     37a:   b2c0        uxtb r0, r0
     37c:   281f        cmp r0, #31
     37e:   d901        bls.n 0x384
     380:   381f        subs r0, #31
     382:   b2c0        uxtb r0, r0
     384:   1e52        subs r2, r2, #1
     386:   b2d2        uxtb r2, r2
     388:   d2f4        bcs.n 0x374
     38a:   bd10        pop {r4, pc}
     38c:   00ec        lsls r4, r5, #3
     38e:   2000        movs r0, #0
     390:   2a00        cmp r2, #0
     392:   6802        ldr r2, [r0, #0]
     394:   d001        beq.n 0x39a
     396:   430a        orrs r2, r1
     398:   e000        b.n 0x39c
     39a:   438a        bics r2, r1
     39c:   6002        str r2, [r0, #0]
     39e:   4770        bx lr
     3a0:   2a00        cmp r2, #0
     3a2:   6842        ldr r2, [r0, #4]
     3a4:   d001        beq.n 0x3aa
     3a6:   430a        orrs r2, r1
     3a8:   e000        b.n 0x3ac
     3aa:   438a        bics r2, r1
     3ac:   6042        str r2, [r0, #4]
     3ae:   4770        bx lr
     3b0:   2a00        cmp r2, #0
     3b2:   6902        ldr r2, [r0, #16]
     3b4:   d001        beq.n 0x3ba
     3b6:   430a        orrs r2, r1
     3b8:   e000        b.n 0x3bc
     3ba:   438a        bics r2, r1
     3bc:   6102        str r2, [r0, #16]
     3be:   4770        bx lr
     3c0:   b142        cbz r2, 0x3d4
     3c2:   2a01        cmp r2, #1
     3c4:   d009        beq.n 0x3da
     3c6:   6882        ldr r2, [r0, #8]
     3c8:   438a        bics r2, r1
     3ca:   6082        str r2, [r0, #8]
     3cc:   68c2        ldr r2, [r0, #12]
     3ce:   438a        bics r2, r1
     3d0:   60c2        str r2, [r0, #12]
     3d2:   4770        bx lr
     3d4:   6882        ldr r2, [r0, #8]
     3d6:   430a        orrs r2, r1
     3d8:   e7f7        b.n 0x3ca
     3da:   68c2        ldr r2, [r0, #12]
     3dc:   430a        orrs r2, r1
     3de:   60c2        str r2, [r0, #12]
     3e0:   6882        ldr r2, [r0, #8]
     3e2:   438a        bics r2, r1
     3e4:   6082        str r2, [r0, #8]
     3e6:   4770        bx lr
     3e8:   b10a        cbz r2, 0x3ee
     3ea:   6241        str r1, [r0, #36]    ; 0x24
     3ec:   4770        bx lr
     3ee:   6281        str r1, [r0, #40]    ; 0x28
     3f0:   4770        bx lr
     3f2:   0380        lsls r0, r0, #14
     3f4:   b200        sxth r0, r0
     3f6:   0c01        lsrs r1, r0, #16
     3f8:   2029        movs r0, #41    ; 0x29
     3fa:   f7ff bfb1   b.w 0x360
     3fe:   4770        bx lr

   0x400:   04 00 00 00
     404:   00 00 00 00
     408:   d9 04 67 11
     40c:   00 00 04 03
     410:   ff ff ff ff
     414:   01 00 00 00
     418:   ff ff ff ff
     41c:   41 00 00 00
     420:   00 04 33 00
     424:   00 04 4b 42
     428:   30 31 36 37
     42c:   00 00 00 00
     430:   ff ff ff ff

     434:   0304        lsls r4, r0, #12
     436:   0409        lsls r1, r1, #16
     438:   0000        movs r0, r0
     43a:   0000        movs r0, r0
     43c:   0000        movs r0, r0
     43e:   3000        adds r0, #0
     440:   0001        movs r1, r0
     442:   3400        adds r4, #0
     444:   2900        cmp r1, #0
     446:   6901        ldr r1, [r0, #16]
     448:   d002        beq.n 0x450
     44a:   f041 0101   orr.w r1, r1, #1
     44e:   e001        b.n 0x454
     450:   f021 0101   bic.w r1, r1, #1
     454:   6101        str r1, [r0, #16]
     456:   4770        bx lr
     458:   b5f0        push {r4, r5, r6, r7, lr}
     45a:   780b        ldrb r3, [r1, #0]
     45c:   6d07        ldr r7, [r0, #80]    ; 0x50
     45e:   eb00 0483   add.w r4, r0, r3, lsl #2
     462:   f104 0240   add.w r2, r4, #64    ; 0x40
     466:   f104 0590   add.w r5, r4, #144    ; 0x90
     46a:   f104 06a0   add.w r6, r4, #160    ; 0xa0
     46e:   005b        lsls r3, r3, #1
     470:   2401        movs r4, #1
     472:   409c        lsls r4, r3
     474:   43e4        mvns r4, r4
     476:   4027        ands r7, r4
     478:   6507        str r7, [r0, #80]    ; 0x50
     47a:   6d47        ldr r7, [r0, #84]    ; 0x54
     47c:   4027        ands r7, r4
     47e:   6547        str r7, [r0, #84]    ; 0x54
     480:   6d44        ldr r4, [r0, #84]    ; 0x54
     482:   794f        ldrb r7, [r1, #5]
     484:   409f        lsls r7, r3
     486:   433c        orrs r4, r7
     488:   6544        str r4, [r0, #84]    ; 0x54
     48a:   6814        ldr r4, [r2, #0]
     48c:   f240 1707   movw r7, #263    ; 0x107
     490:   43bc        bics r4, r7
     492:   6014        str r4, [r2, #0]
     494:   6814        ldr r4, [r2, #0]
     496:   884f        ldrh r7, [r1, #2]
     498:   433c        orrs r4, r7
     49a:   6014        str r4, [r2, #0]
     49c:   88ca        ldrh r2, [r1, #6]
     49e:   602a        str r2, [r5, #0]
     4a0:   890a        ldrh r2, [r1, #8]
     4a2:   6032        str r2, [r6, #0]
     4a4:   6d02        ldr r2, [r0, #80]    ; 0x50
     4a6:   7909        ldrb r1, [r1, #4]
     4a8:   4099        lsls r1, r3
     4aa:   430a        orrs r2, r1
     4ac:   6502        str r2, [r0, #80]    ; 0x50
     4ae:   bdf0        pop {r4, r5, r6, r7, pc}
     4b0:   880a        ldrh r2, [r1, #0]
     4b2:   f8c0 2088   str.w r2, [r0, #136]    ; 0x88
     4b6:   884a        ldrh r2, [r1, #2]
     4b8:   f8c0 2084   str.w r2, [r0, #132]    ; 0x84
     4bc:   6802        ldr r2, [r0, #0]
     4be:   f422 3240   bic.w r2, r2, #196608    ; 0x30000
     4c2:   6002        str r2, [r0, #0]
     4c4:   6802        ldr r2, [r0, #0]
     4c6:   f022 7280   bic.w r2, r2, #16777216    ; 0x1000000
     4ca:   6002        str r2, [r0, #0]
     4cc:   6802        ldr r2, [r0, #0]
     4ce:   684b        ldr r3, [r1, #4]
     4d0:   431a        orrs r2, r3
     4d2:   6002        str r2, [r0, #0]
     4d4:   8909        ldrh r1, [r1, #8]
     4d6:   6781        str r1, [r0, #120]    ; 0x78
     4d8:   4770        bx lr
     4da:   0000        movs r0, r0
     4dc:   4a1c        ldr r2, [pc, #112]    ; (0x550)
     4de:   b510        push {r4, lr}
     4e0:   5c12        ldrb r2, [r2, r0]
     4e2:   2ae8        cmp r2, #232    ; 0xe8
     4e4:   d031        beq.n 0x54a
     4e6:   f1a2 00e0   sub.w r0, r2, #224    ; 0xe0
     4ea:   2401        movs r4, #1
     4ec:   4b19        ldr r3, [pc, #100]    ; (0x554)
     4ee:   2807        cmp r0, #7
     4f0:   d80c        bhi.n 0x50c
     4f2:   f002 0007   and.w r0, r2, #7
     4f6:   461a        mov r2, r3
     4f8:   fa04 f000   lsl.w r0, r4, r0
     4fc:   7812        ldrb r2, [r2, #0]
     4fe:   b2c0        uxtb r0, r0
     500:   b109        cbz r1, 0x506
     502:   4302        orrs r2, r0
     504:   e000        b.n 0x508
     506:   4382        bics r2, r0
     508:   701a        strb r2, [r3, #0]
     50a:   e017        b.n 0x53c
     50c:   2a91        cmp r2, #145    ; 0x91
     50e:   d81c        bhi.n 0x54a
     510:   f04f 0000   mov.w r0, #0
     514:   b159        cbz r1, 0x52e
     516:   1819        adds r1, r3, r0
     518:   7889        ldrb r1, [r1, #2]
     51a:   b129        cbz r1, 0x528
     51c:   1c40        adds r0, r0, #1
     51e:   b2c0        uxtb r0, r0
     520:   2806        cmp r0, #6
     522:   d3f8        bcc.n 0x516
     524:   2000        movs r0, #0
     526:   bd10        pop {r4, pc}
     528:   4418        add r0, r3
     52a:   7082        strb r2, [r0, #2]
     52c:   e006        b.n 0x53c
     52e:   1819        adds r1, r3, r0
     530:   7889        ldrb r1, [r1, #2]
     532:   4291        cmp r1, r2
     534:   d105        bne.n 0x542
     536:   4418        add r0, r3
     538:   2100        movs r1, #0
     53a:   7081        strb r1, [r0, #2]
     53c:   4806        ldr r0, [pc, #24]    ; (0x558)
     53e:   7004        strb r4, [r0, #0]
     540:   e003        b.n 0x54a
     542:   1c40        adds r0, r0, #1
     544:   b2c0        uxtb r0, r0
     546:   2806        cmp r0, #6
     548:   d3f1        bcc.n 0x52e
     54a:   2001        movs r0, #1
     54c:   bd10        pop {r4, pc}
     54e:   0000        movs r0, r0
     550:   1f84        subs r4, r0, #6
     552:   0000        movs r0, r0
     554:   0038        movs r0, r7
     556:   2000        movs r0, #0
     558:   001c        movs r4, r3
     55a:   2000        movs r0, #0

   0x55c:   b510        push {r4, lr}
     55e:   4c18        ldr r4, [pc, #96]   ; (0x5c0)
     560:   b1b0        cbz r0, 0x590

     562:   2100        movs r1, #0
     564:   4620        mov r0, r4
     566:   f7ff fe37   bl 0x1d8            ; call bftm_set_mien(BFTM0, 0)

     56a:   2100        movs r1, #0
     56c:   4620        mov r0, r4
     56e:   f7ff fe29   bl 0x1c4            ; call bftm_set_cen(BFTM0, 0)

     572:   4620        mov r0, r4
     574:   f7ff fdbe   bl 0xf4             ; call bftm_clear(BFTM0)

     578:   2029        movs r0, #41
     57a:   f000 f875   bl 0x668            ; call nvic_disable_intr(41)

     57e:   f000 f8b9   bl 0x6f4

     582:   2001        movs r0, #1
     584:   f000 fb70   bl 0xc68

     588:   e8bd 4010   ldmia.w sp!, {r4, lr}
     58c:   f000 bc00   b.w 0xd90

   0x590:   2000        movs r0, #0
     592:   f000 fb69   bl 0xc68

     596:   2100        movs r1, #0
     598:   4620        mov r0, r4
     59a:   f7ff fd9d   bl 0xd8             ; call bftm_set_counter(BFTM0, 0)

     59e:   4620        mov r0, r4
     5a0:   f7ff fda8   bl 0xf4             ; call bftm_clear(BFTM0)

     5a4:   2101        movs r1, #1
     5a6:   4620        mov r0, r4
     5a8:   f7ff fe0c   bl 0x1c4            ; call bftm_set_cen(BFTM0, 1)

     5ac:   2101        movs r1, #1
     5ae:   4620        mov r0, r4
     5b0:   f7ff fe12   bl 0x1d8            ; call bftm_set_mien(BFTM0, 1)

     5b4:   4903        ldr r1, [pc, #12]       ; (0x5c4)
     5b6:   f44f 7000   mov.w r0, #512          ; 0x200
     5ba:   f8c1 0100   str.w r0, [r1, #256]    ; 0x100
     5be:   bd10        pop {r4, pc}

   0x5c0:   0x40076000  ; BFTM0
   0x5c4:   0xe000e004

     5c8:   b510        push {r4, lr}
     5ca:   2000        movs r0, #0
     5cc:   f44f 3280   mov.w r2, #65536    ; 0x10000
     5d0:   2301        movs r3, #1
     5d2:   4601        mov r1, r0
     5d4:   f7ff fe7a   bl 0x2cc                ; call ckcu_clocks_enable
     5d8:   e8bd 4010   ldmia.w sp!, {r4, lr}
     5dc:   f648 419f   movw r1, #35999    ; 0x8c9f
     5e0:   4801        ldr r0, [pc, #4]    ; (0x5e8)
     5e2:   f7ff bd29   b.w 0x38
     5e6:   0000        movs r0, r0
     5e8:   6000        str r0, [r0, #0]
     5ea:   4007        ands r7, r0
     5ec:   491c        ldr r1, [pc, #112]    ; (0x660)
     5ee:   b510        push {r4, lr}
     5f0:   6808        ldr r0, [r1, #0]
     5f2:   f64f 02ff   movw r2, #63743    ; 0xf8ff
     5f6:   4010        ands r0, r2
     5f8:   4a1a        ldr r2, [pc, #104]    ; (0x664)
     5fa:   f440 7040   orr.w r0, r0, #768    ; 0x300
     5fe:   4310        orrs r0, r2
     600:   6008        str r0, [r1, #0]
     602:   2200        movs r2, #0
     604:   4611        mov r1, r2
     606:   2003        movs r0, #3
     608:   f000 f839   bl 0x67e
     60c:   4601        mov r1, r0
     60e:   202b        movs r0, #43    ; 0x2b
     610:   f000 f84e   bl 0x6b0
     614:   2200        movs r2, #0
     616:   4611        mov r1, r2
     618:   2003        movs r0, #3
     61a:   f000 f830   bl 0x67e
     61e:   4601        mov r1, r0
     620:   202c        movs r0, #44    ; 0x2c
     622:   f000 f845   bl 0x6b0
     626:   2200        movs r2, #0
     628:   2101        movs r1, #1
     62a:   2003        movs r0, #3
     62c:   f000 f827   bl 0x67e
     630:   4601        mov r1, r0
     632:   202a        movs r0, #42    ; 0x2a
     634:   f000 f83c   bl 0x6b0
     638:   2200        movs r2, #0
     63a:   2102        movs r1, #2
     63c:   2003        movs r0, #3
     63e:   f000 f81e   bl 0x67e
     642:   4601        mov r1, r0
     644:   2029        movs r0, #41    ; 0x29
     646:   f000 f833   bl 0x6b0
     64a:   2200        movs r2, #0
     64c:   2102        movs r1, #2
     64e:   2003        movs r0, #3
     650:   f000 f815   bl 0x67e
     654:   4601        mov r1, r0
     656:   e8bd 4010   ldmia.w sp!, {r4, lr}
     65a:   2035        movs r0, #53    ; 0x35
     65c:   f000 b828   b.w 0x6b0
     660:   ed0c e000   stc 0, cr14, [ip, #-0]
     664:   0000        movs r0, r0
     666:   05fa        lsls r2, r7, #23

nvic_disable_intr:
    ; r0 = interrupt number
   0x668:   f000 021f   and.w r2, r0, #31
     66c:   2101        movs r1, #1
     66e:   4091        lsls r1, r2
     670:   0940        lsrs r0, r0, #5
     672:   0080        lsls r0, r0, #2
     674:   f100 20e0   add.w r0, r0, #3758153728    ; 0xe000e000
     678:   f8c0 1180   str.w r1, [r0, #384]    ; 0x180
     67c:   4770        bx lr

     67e:   b530        push {r4, r5, lr}
     680:   f000 0307   and.w r3, r0, #7
     684:   f1c3 0407   rsb r4, r3, #7
     688:   2c04        cmp r4, #4
     68a:   d900        bls.n 0x68e
     68c:   2404        movs r4, #4
     68e:   1d18        adds r0, r3, #4
     690:   2807        cmp r0, #7
     692:   d201        bcs.n 0x698
     694:   2300        movs r3, #0
     696:   e000        b.n 0x69a
     698:   1edb        subs r3, r3, #3
     69a:   2501        movs r5, #1
     69c:   fa05 f004   lsl.w r0, r5, r4
     6a0:   1e40        subs r0, r0, #1
     6a2:   4008        ands r0, r1
     6a4:   4098        lsls r0, r3
     6a6:   409d        lsls r5, r3
     6a8:   1e6d        subs r5, r5, #1
     6aa:   4015        ands r5, r2
     6ac:   4328        orrs r0, r5
     6ae:   bd30        pop {r4, r5, pc}
     6b0:   0709        lsls r1, r1, #28
     6b2:   0e09        lsrs r1, r1, #24
     6b4:   2800        cmp r0, #0
     6b6:   da06        bge.n 0x6c6
     6b8:   f000 000f   and.w r0, r0, #15
     6bc:   f100 20e0   add.w r0, r0, #3758153728    ; 0xe000e000
     6c0:   f880 1d14   strb.w r1, [r0, #3348]    ; 0xd14
     6c4:   4770        bx lr
     6c6:   f100 20e0   add.w r0, r0, #3758153728    ; 0xe000e000
     6ca:   f880 1400   strb.w r1, [r0, #1024]    ; 0x400
     6ce:   4770        bx lr
     6d0:   b510        push {r4, lr}
     6d2:   f44f 7200   mov.w r2, #512    ; 0x200
     6d6:   2100        movs r1, #0
     6d8:   0250        lsls r0, r2, #9
     6da:   2301        movs r3, #1
     6dc:   f7ff fdf6   bl 0x2cc                ; call ckcu_clocks_enable
     6e0:   2201        movs r2, #1
     6e2:   e8bd 4010   ldmia.w sp!, {r4, lr}
     6e6:   4611        mov r1, r2
     6e8:   4801        ldr r0, [pc, #4]    ; (0x6f0)
     6ea:   f7ff be61   b.w 0x3b0
     6ee:   0000        movs r0, r0
     6f0:   4000        ands r0, r0
     6f2:   400b        ands r3, r1

     6f4:   2200        movs r2, #0
     6f6:   4611        mov r1, r2
     6f8:   2002        movs r0, #2
     6fa:   f7ff bd77   b.w 0x1ec

     6fe:   2204        movs r2, #4
     700:   2100        movs r1, #0
     702:   2002        movs r0, #2
     704:   f7ff bd72   b.w 0x1ec
     708:   b570        push {r4, r5, r6, lr}
     70a:   490d        ldr r1, [pc, #52]    ; (0x740)
     70c:   680c        ldr r4, [r1, #0]
     70e:   4d0c        ldr r5, [pc, #48]    ; (0x740)
     710:   3548        adds r5, #72    ; 0x48
     712:   682b        ldr r3, [r5, #0]
     714:   2201        movs r2, #1
     716:   600a        str r2, [r1, #0]
     718:   2200        movs r2, #0
     71a:   602a        str r2, [r5, #0]
     71c:   4e09        ldr r6, [pc, #36]    ; (0x744)
     71e:   f8c6 209c   str.w r2, [r6, #156]    ; 0x9c
     722:   f8c6 208c   str.w r2, [r6, #140]    ; 0x8c
     726:   600c        str r4, [r1, #0]
     728:   4907        ldr r1, [pc, #28]    ; (0x748)
     72a:   680a        ldr r2, [r1, #0]
     72c:   f042 0204   orr.w r2, r2, #4
     730:   600a        str r2, [r1, #0]
     732:   b110        cbz r0, 0x73a
     734:   bf30        wfi
     736:   602b        str r3, [r5, #0]
     738:   bd70        pop {r4, r5, r6, pc}
     73a:   bf20        wfe
     73c:   e7fb        b.n 0x736
     73e:   0000        movs r0, r0
     740:   0618        lsls r0, r3, #24
     742:   4310        orrs r0, r2
     744:   2000        movs r0, #0
     746:   42d4        cmn r4, r2
     748:   ed10 e000   ldc 0, cr14, [r0, #-0]
     74c:   e92d 47f0   stmdb sp!, {r4, r5, r6, r7, r8, r9, sl, lr}
     750:   4c0e        ldr r4, [pc, #56]    ; (0x78c)
     752:   6827        ldr r7, [r4, #0]
     754:   4d0d        ldr r5, [pc, #52]    ; (0x78c)
     756:   3548        adds r5, #72    ; 0x48
     758:   682e        ldr r6, [r5, #0]
     75a:   f04f 0901   mov.w r9, #1
     75e:   f8c4 9000   str.w r9, [r4]
     762:   f04f 0800   mov.w r8, #0
     766:   f8c5 8000   str.w r8, [r5]
     76a:   f000 f9b1   bl 0xad0
     76e:   4808        ldr r0, [pc, #32]    ; (0x790)
     770:   f8c0 809c   str.w r8, [r0, #156]    ; 0x9c
     774:   f8c0 908c   str.w r9, [r0, #140]    ; 0x8c
     778:   6027        str r7, [r4, #0]
     77a:   4806        ldr r0, [pc, #24]    ; (0x794)
     77c:   6801        ldr r1, [r0, #0]
     77e:   f041 0104   orr.w r1, r1, #4
     782:   6001        str r1, [r0, #0]
     784:   bf20        wfe
     786:   602e        str r6, [r5, #0]
     788:   e8bd 87f0   ldmia.w sp!, {r4, r5, r6, r7, r8, r9, sl, pc}
     78c:   0618        lsls r0, r3, #24
     78e:   4310        orrs r0, r2
     790:   2000        movs r0, #0
     792:   42d4        cmn r4, r2
     794:   ed10 e000   ldc 0, cr14, [r0, #-0]
     798:   4904        ldr r1, [pc, #16]    ; (0x7ac)
     79a:   680a        ldr r2, [r1, #0]
     79c:   f022 0204   bic.w r2, r2, #4
     7a0:   600a        str r2, [r1, #0]
     7a2:   b108        cbz r0, 0x7a8
     7a4:   bf30        wfi
     7a6:   4770        bx lr
     7a8:   bf20        wfe
     7aa:   4770        bx lr
     7ac:   ed10 e000   ldc 0, cr14, [r0, #-0]

decrypt_packet:
    ; r0 = ptr
    ; r1 = len
   0x7b0:   b5f0        push {r4, r5, r6, r7, lr}
     7b2:   b0c0        sub sp, #256    ; 0x100
     7b4:   4604        mov r4, r0
     7b6:   460d        mov r5, r1

     7b8:   4668        mov r0, sp
     7ba:   f000 ff35   bl 0x1628           ; call generate

     7be:   2200        movs r2, #0
     7c0:   4613        mov r3, r2
     7c2:   4669        mov r1, sp
     7c4:   e00e        b.n 0x7e4

    ; loop
   0x7c6:   1c52        adds r2, r2, #1     ; r2++
     7c8:   b2d2        uxtb r2, r2
     7ca:   5c88        ldrb r0, [r1, r2]   ; r0 = [r1 + r2]
     7cc:   4403        add r3, r0          ; r3 += r0
     7ce:   b2db        uxtb r3, r3

     7d0:   5cce        ldrb r6, [r1, r3]   ; r6 = [r1 + r3]
     7d2:   548e        strb r6, [r1, r2]   ; [r1 + r2] = r6

     7d4:   54c8        strb r0, [r1, r3]
     7d6:   4430        add r0, r6          ; r0 += r6
     7d8:   b2c0        uxtb r0, r0

     7da:   7827        ldrb r7, [r4, #0]   ; r7 = [r4]
     7dc:   5c08        ldrb r0, [r1, r0]   ; r0 = [r1 + r0]
     7de:   4047        eors r7, r0         ; r7 ^= r0
     7e0:   f804 7b01   strb.w r7, [r4], #1 ; [r4] = r7
                                            ; r4++
   0x7e4:   1e6d        subs r5, r5, #1     ; r5--
     7e6:   d2ee        bcs.n 0x7c6

     7e8:   b040        add sp, #256    ; 0x100
     7ea:   bdf0        pop {r4, r5, r6, r7, pc}

flash_write_buffer:
    ; r0 = target addr
    ; r1 = src
    ; r2 = length
   0x7ec:   b570        push {r4, r5, r6, lr}
     7ee:   0892        lsrs r2, r2, #2
     7f0:   2404        movs r4, #4
     7f2:   4b06        ldr r3, [pc, #24]   ; (0x80c)
     7f4:   2514        movs r5, #20
     7f6:   e005        b.n 0x804

    ; loop
   0x7f8:   60dc        str r4, [r3, #12]
     7fa:   6018        str r0, [r3, #0]
     7fc:   c940        ldmia r1!, {r6}
     7fe:   605e        str r6, [r3, #4]
     800:   611d        str r5, [r3, #16]
     802:   1d00        adds r0, r0, #4
   0x804:   1e52        subs r2, r2, #1
     806:   d2f7        bcs.n 0x7f8

     808:   bd70        pop {r4, r5, r6, pc}
     80a:   0000

   0x80c:   0x40080000  ; FMC

handle_frame:
   0x810:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
     814:   4d71        ldr r5, [pc, #452]    ; (0x9dc)
     816:   7828        ldrb r0, [r5, #0]
     818:   2801        cmp r0, #1
     81a:   d170        bne.n 0x8fe

     81c:   4e70        ldr r6, [pc, #448]  ; (0x9e0)
     81e:   2400        movs r4, #0
     820:   4630        mov r0, r6
     822:   7831        ldrb r1, [r6, #0]   ; r1 = cmd
     824:   7840        ldrb r0, [r0, #1]   ; r0 = subcmd
     826:   46a4        mov ip, r4

     828:   2910        cmp r1, #16
     82a:   d00f        beq.n 0x84c
     82c:   4632        mov r2, r6
     82e:   f44f 4e4c   mov.w lr, #52224        ; 0xcc00
     832:   6853        ldr r3, [r2, #4]
     834:   f44f 5250   mov.w r2, #13312        ; 0x3400
     838:   f503 5740   add.w r7, r3, #12288    ; 0x3000
     83c:   291d        cmp r1, #29
     83e:   d047        beq.n 0x8d0
     840:   dc09        bgt.n 0x856
     842:   2911        cmp r1, #17
     844:   d00c        beq.n 0x860
     846:   2912        cmp r1, #18
     848:   d170        bne.n 0x92c
     84a:   e00c        b.n 0x866

    ; if r1 == 16 (0x10)
   0x84c:   2802        cmp r0, #2
     84e:   d16d        bne.n 0x92c
     850:   f8c6 c004   str.w ip, [r6, #4]
     854:   e085        b.n 0x962

    ; if r1 > 29 (0x1d)
   0x856:   291e        cmp r1, #30
     858:   d078        beq.n 0x94c
     85a:   291f        cmp r1, #31
     85c:   d166        bne.n 0x92c
     85e:   e091        b.n 0x984

    ; if r1 == 17 (0x11) reset command
   0x860:   f000 f8c2   bl 0x9e8            ; call reset_builtin
     864:   e082        b.n 0x96c

    ; if r1 == 18 (0x12) read command
   0x866:   f44f 6380   mov.w r3, #1024    ; 0x400
     86a:   2820        cmp r0, #32
     86c:   d30e        bcc.n 0x88c

        ; else r0 >= 0x20
     86e:   f1a0 011f   sub.w r1, r0, #31
     872:   ebc1 1101   rsb r1, r1, r1, lsl #4
     876:   ebb3 0f81   cmp.w r3, r1, lsl #2
     87a:   db07        blt.n 0x88c

     87c:   ebc0 1000   rsb r0, r0, r0, lsl #4
     880:   f44f 5122   mov.w r1, #10368            ; 0x2880
     884:   eb01 0080   add.w r0, r1, r0, lsl #2
     888:   213c        movs r1, #60                ; 0x3c
     88a:   e06c        b.n 0x966

   0x88c:   b120        cbz r0, 0x898
     88e:   2801        cmp r0, #1
     890:   d016        beq.n 0x8c0
     892:   2802        cmp r0, #2
     894:   d14a        bne.n 0x92c
     896:   e017        b.n 0x8c8

        ; if r0 == 0
   0x898:   781a        ldrb r2, [r3, #0]
     89a:   4618        mov r0, r3
     89c:   2a04        cmp r2, #4
     89e:   d00d        beq.n 0x8bc

     8a0:   2220        movs r2, #32
     8a2:   4619        mov r1, r3
     8a4:   1d30        adds r0, r6, #4
     8a6:   f7ff fbcb   bl 0x40                 ; call memcpy(r6 + 4, 0x400, 32)

     8aa:   484e        ldr r0, [pc, #312]      ; (0x9e4)
     8ac:   f8d0 1180   ldr.w r1, [r0, #384]    ; 0x180 undocumented FMC register
     8b0:   6271        str r1, [r6, #36]       ; 0x24
     8b2:   f8d0 018c   ldr.w r0, [r0, #396]    ; 0x18c undocumented FMC register
     8b6:   2128        movs r1, #40
     8b8:   62b0        str r0, [r6, #40]       ; 0x28
     8ba:   e053        b.n 0x964               ; read 40 bytes back from packet...

   0x8bc:   2134        movs r1, #52
     8be:   e052        b.n 0x966               ; read 52 bytes from 0x400

        ; if r0 == 1
   0x8c0:   2104        movs r1, #4
     8c2:   f44f 5070   mov.w r0, #15360    ; 0x3c00
     8c6:   e04e        b.n 0x966           ; read 4 bytes from 0x3c00

        ; if r0 == 2
   0x8c8:   f886 c004   strb.w ip, [r6, #4]
     8cc:   2101        movs r1, #1
     8ce:   e049        b.n 0x964           ; read 1 byte back from packet...

    ; if r1 == 0x1d (firmware command)
   0x8d0:   0799        lsls r1, r3, #30
     8d2:   d179        bne.n 0x9c8
     8d4:   68b1        ldr r1, [r6, #8]
     8d6:   b349        cbz r1, 0x92c
     8d8:   078c        lsls r4, r1, #30
     8da:   d175        bne.n 0x9c8
     8dc:   440b        add r3, r1
     8de:   4573        cmp r3, lr
     8e0:   d872        bhi.n 0x9c8
     8e2:   6077        str r7, [r6, #4]

     8e4:   b120        cbz r0, 0x8f0
     8e6:   2801        cmp r0, #1
     8e8:   d022        beq.n 0x930
     8ea:   2802        cmp r0, #2
     8ec:   d16c        bne.n 0x9c8
     8ee:   e01f        b.n 0x930

        ; if r0 == 0 (erase)
   0x8f0:   1878        adds r0, r7, r1
     8f2:   f8c6 c008   str.w ip, [r6, #8]
     8f6:   e9c6 7003   strd r7, r0, [r6, #12]
     8fa:   4638        mov r0, r7
     8fc:   e00d        b.n 0x91a           ; enter erase loop

   0x8fe:   e03f        b.n 0x980           ; return

   0x900:   f7ff fd00   bl 0x304            ; call flash_page_erase
     904:   b960        cbnz r0, 0x920
     906:   f000 fe87   bl 0x1618           ; call watchdog_reload_timer
     90a:   68b0        ldr r0, [r6, #8]
     90c:   f500 6080   add.w r0, r0, #1024 ; 0x400
     910:   60b0        str r0, [r6, #8]
     912:   68f0        ldr r0, [r6, #12]
     914:   f500 6080   add.w r0, r0, #1024 ; 0x400
     918:   60f0        str r0, [r6, #12]
   0x91a:   6931        ldr r1, [r6, #16]
     91c:   4288        cmp r0, r1
     91e:   d3ef        bcc.n 0x900

    ; erase exit
   0x920:   6870        ldr r0, [r6, #4]
     922:   2108        movs r1, #8
     924:   f5a0 5040   sub.w r0, r0, #12288    ; 0x3000
     928:   6070        str r0, [r6, #4]
     92a:   e01b        b.n 0x964

    ; else / error handler
   0x92c:   e04c        b.n 0x9c8

   0x92e:   e00d        b.n 0x94c

        ; if r0 == 1 (sum firmware)
        ; if r0 == 2 (crc firmware)
   0x930:   4297        cmp r7, r2
     932:   d349        bcc.n 0x9c8
     934:   f5b1 5f80   cmp.w r1, #4096    ; 0x1000
     938:   d346        bcc.n 0x9c8
     93a:   2802        cmp r0, #2
     93c:   d004        beq.n 0x948
     93e:   2200        movs r2, #0
   0x940:   4638        mov r0, r7
     942:   f000 fe91   bl 0x1668           ; call firmware_check(0x3400, [r6 + 8], r2)
     946:   e00b        b.n 0x960           ; write return to response

   0x948:   2201        movs r2, #1
     94a:   e7f9        b.n 0x940

    ; if r1 == 30 (0x1e)
   0x94c:   b130        cbz r0, 0x95c
     94e:   2801        cmp r0, #1
     950:   d13a        bne.n 0x9c8

        ; if r0 == 1
   0x952:   4573        cmp r3, lr
     954:   d238        bcs.n 0x9c8         ;
     956:   0798        lsls r0, r3, #30
     958:   d136        bne.n 0x9c8         ; error if address not word aligned
     95a:   606f        str r7, [r5, #4]

        ; if r0 == 0
   0x95c:   6868        ldr r0, [r5, #4]
     95e:   e030        b.n 0x9c2

   0x960:   6070        str r0, [r6, #4]

     962:   2104        movs r1, #4
   0x964:   1d30        adds r0, r6, #4
   0x966:   f000 f881   bl 0xa6c            ; call flash_read_packet

     96a:   2401        movs r4, #1
     96c:   7828        ldrb r0, [r5, #0]
     96e:   2801        cmp r0, #1
     970:   d106        bne.n 0x980
     972:   b34c        cbz r4, 0x9c8
     974:   213c        movs r1, #60    ; 0x3c
     976:   1d30        adds r0, r6, #4
   0x978:   f7ff fb7b   bl 0x72
     97c:   2002        movs r0, #2
     97e:   7028        strb r0, [r5, #0]
   0x980:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}

    ; if r1 == 0x1f (write)
   0x984:   b300        cbz r0, 0x9c8
     986:   0781        lsls r1, r0, #30    ; error if length 0
     988:   d11e        bne.n 0x9c8         ; error if length not multiple of 4
     98a:   283c        cmp r0, #60
     98c:   d81c        bhi.n 0x9c8         ; error if length > 60
     98e:   6869        ldr r1, [r5, #4]    ; write addr
     990:   1843        adds r3, r0, r1
     992:   f5b3 4f7c   cmp.w r3, #64512
     996:   d817        bhi.n 0x9c8         ; error if addr + len > 0xfc00
     998:   4291        cmp r1, r2
     99a:   d202        bcs.n 0x9a2         ; decrypt if addr >= 0x3400
     99c:   4293        cmp r3, r2
     99e:   d813        bhi.n 0x9c8         ; error if addr + len > 0x3400
     9a0:   e003        b.n 0x9aa           ; jump to write

   0x9a2:   4601        mov r1, r0
     9a4:   1d30        adds r0, r6, #4
     9a6:   f7ff ff03   bl 0x7b0            ; call decrypt_packet(r6 + 4, len)

   0x9aa:   7872        ldrb r2, [r6, #1]
     9ac:   1d31        adds r1, r6, #4
     9ae:   6868        ldr r0, [r5, #4]
     9b0:   f7ff ff1c   bl 0x7ec            ; call flash_write_buffer([r5 + 4], r6 + 4, [r6 + 1])

    ; increment target address
     9b4:   7870        ldrb r0, [r6, #1]
     9b6:   6869        ldr r1, [r5, #4]
     9b8:   4408        add r0, r1
     9ba:   f240 211e   movw r1, #542       ; 0x21e
     9be:   6068        str r0, [r5, #4]
     9c0:   8031        strh r1, [r6, #0]

   0x9c2:   f5a0 5040   sub.w r0, r0, #12288    ; 0x3000
     9c6:   e7cb        b.n 0x960

    ; error handler
   0x9c8:   6830        ldr r0, [r6, #0]
     9ca:   6070        str r0, [r6, #4]
     9cc:   f64a 20ff   movw r0, #43775    ; 0xaaff
     9d0:   6030        str r0, [r6, #0]
     9d2:   4803        ldr r0, [pc, #12]    ; (0x9e0)
     9d4:   2138        movs r1, #56    ; 0x38
     9d6:   3008        adds r0, #8
     9d8:   e7ce        b.n 0x978
     9da:   0000

   0x9dc:   0x20000004  ; pointer_br_1
   0x9e0:   0x20000084
   0x9e4:   0x40080000  ; FMC

reset_builtin:
    ; r0 = 0/1/2
    ; 0: reset key 0x55aafaf5
    ; 1: reset key 0x55aafaf0
    ; 2: usb disconnect, wait event
   0x9e8:   b510        push {r4, lr}
     9ea:   491b        ldr r1, [pc, #108]    ; (0xa58)
     9ec:   b168        cbz r0, 0xa0a
     9ee:   2801        cmp r0, #1
     9f0:   d00d        beq.n 0xa0e
     9f2:   2802        cmp r0, #2
     9f4:   d12f        bne.n 0xa56
     9f6:   2035        movs r0, #53    ; 0x35
     9f8:   f7ff fe36   bl 0x668            ; call nvic_disable_intr(53)
     9fc:   2000        movs r0, #0
     9fe:   f000 fc31   bl 0x1264
     a02:   e8bd 4010   ldmia.w sp!, {r4, lr}
     a06:   f7ff bea1   b.w 0x74c
     a0a:   4814        ldr r0, [pc, #80]    ; (0xa5c)
     a0c:   e001        b.n 0xa12
     a0e:   4813        ldr r0, [pc, #76]    ; (0xa5c)
     a10:   1f40        subs r0, r0, #5
     a12:   6008        str r0, [r1, #0]
     a14:   2100        movs r1, #0
     a16:   f44f 3080   mov.w r0, #65536    ; 0x10000
     a1a:   2301        movs r3, #1
     a1c:   460a        mov r2, r1
     a1e:   f7ff fc55   bl 0x2cc                ; call ckcu_clocks_enable
     a22:   490f        ldr r1, [pc, #60]    ; (0xa60)
     a24:   f44f 7000   mov.w r0, #512    ; 0x200
     a28:   6248        str r0, [r1, #36]    ; 0x24
     a2a:   2035        movs r0, #53    ; 0x35
     a2c:   f7ff fe1c   bl 0x668            ; call nvic_disable_intr(53)
     a30:   2000        movs r0, #0
     a32:   f000 fc17   bl 0x1264
     a36:   f644 6020   movw r0, #20000    ; 0x4e20
     a3a:   f7ff fb62   bl 0x102
     a3e:   f3bf 8f4f   dsb sy
     a42:   4808        ldr r0, [pc, #32]    ; (0xa64)
     a44:   6801        ldr r1, [r0, #0]
     a46:   4a08        ldr r2, [pc, #32]    ; (0xa68)
     a48:   f401 61e0   and.w r1, r1, #1792    ; 0x700
     a4c:   4311        orrs r1, r2
     a4e:   6001        str r1, [r0, #0]
     a50:   f3bf 8f4f   dsb sy
     a54:   e7fe        b.n 0xa54
     a56:   bd10        pop {r4, pc}

     a58:   0x20003ffc
     a5c:   0x55aafaf5  ; reset key
     a60:   0x400b0000  ; GPIO A
     a64:   0xe000ed0c
     a68:   0x05fa0004  ; AIRCR key and reset

flash_read_packet:
    ; r0 = src
    ; r1 = len
   0xa6c:   b570        push {r4, r5, r6, lr}
     a6e:   460c        mov r4, r1
     a70:   4a09        ldr r2, [pc, #36]    ; (0xa98)
     a72:   4601        mov r1, r0
     a74:   2002        movs r0, #2
     a76:   7010        strb r0, [r2, #0]
     a78:   4808        ldr r0, [pc, #32]    ; (0xa9c)
     a7a:   1f05        subs r5, r0, #4
     a7c:   4281        cmp r1, r0
     a7e:   d003        beq.n 0xa88
     a80:   4622        mov r2, r4
     a82:   1d28        adds r0, r5, #4
     a84:   f7ff fadc   bl 0x40
     a88:   1928        adds r0, r5, r4
     a8a:   f1c4 013c   rsb r1, r4, #60    ; 0x3c
     a8e:   e8bd 4070   ldmia.w sp!, {r4, r5, r6, lr}
     a92:   1d00        adds r0, r0, #4
     a94:   f7ff baed   b.w 0x72

     a98:   0x20000004
     a9c:   0x20000088

     aa0:   b5f0        push {r4, r5, r6, r7, lr}
     aa2:   4f0a        ldr r7, [pc, #40]    ; (0xacc)
     aa4:   f8d7 4104   ldr.w r4, [r7, #260]    ; 0x104
     aa8:   f8d7 5108   ldr.w r5, [r7, #264]    ; 0x108
     aac:   f8d7 610c   ldr.w r6, [r7, #268]    ; 0x10c
     ab0:   4384        bics r4, r0
     ab2:   438d        bics r5, r1
     ab4:   4396        bics r6, r2
     ab6:   b113        cbz r3, 0xabe
     ab8:   4304        orrs r4, r0
     aba:   430d        orrs r5, r1
     abc:   4316        orrs r6, r2
     abe:   f8c7 4104   str.w r4, [r7, #260]    ; 0x104
     ac2:   f8c7 5108   str.w r5, [r7, #264]    ; 0x108
     ac6:   f8c7 610c   str.w r6, [r7, #268]    ; 0x10c
     aca:   bdf0        pop {r4, r5, r6, r7, pc}

     acc:   0x40088000

     ad0:   4a07        ldr r2, [pc, #28]    ; (0xaf0)
     ad2:   2100        movs r1, #0
     ad4:   f44f 50e1   mov.w r0, #7200    ; 0x1c20
     ad8:   f8c2 1108   str.w r1, [r2, #264]    ; 0x108
     adc:   1e40        subs r0, r0, #1
     ade:   d2fd        bcs.n 0xadc
     ae0:   2001        movs r0, #1
     ae2:   f8c2 0108   str.w r0, [r2, #264]    ; 0x108
     ae6:   4803        ldr r0, [pc, #12]    ; (0xaf4)
     ae8:   6881        ldr r1, [r0, #8]
     aea:   0689        lsls r1, r1, #26
     aec:   d5fc        bpl.n 0xae8
     aee:   4770        bx lr

     af0:   0x42d40000
     af4:   0x40088000

   0xaf8:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
     afc:   270a        movs r7, #10
     afe:   4d16        ldr r5, [pc, #88]    ; (0xb58)
     b00:   e025        b.n 0xb4e
     b02:   4915        ldr r1, [pc, #84]    ; (0xb58)
     b04:   eb07 0047   add.w r0, r7, r7, lsl #1
     b08:   4408        add r0, r1
     b0a:   f815 1d01   ldrb.w r1, [r5, #-1]!
     b0e:   7880        ldrb r0, [r0, #2]
     b10:   4048        eors r0, r1
     b12:   ea5f 0800   movs.w r8, r0
     b16:   d01a        beq.n 0xb4e
     b18:   2480        movs r4, #128    ; 0x80
     b1a:   2608        movs r6, #8
     b1c:   e014        b.n 0xb48
     b1e:   ea18 0f04   tst.w r8, r4
     b22:   d010        beq.n 0xb46
     b24:   7828        ldrb r0, [r5, #0]
     b26:   4060        eors r0, r4
     b28:   7028        strb r0, [r5, #0]
     b2a:   4220        tst r0, r4
     b2c:   d101        bne.n 0xb32
     b2e:   2101        movs r1, #1
     b30:   e000        b.n 0xb34
     b32:   2100        movs r1, #0
     b34:   eb06 00c7   add.w r0, r6, r7, lsl #3
     b38:   b2c0        uxtb r0, r0
     b3a:   f7ff fccf   bl 0x4dc
     b3e:   b910        cbnz r0, 0xb46
     b40:   7828        ldrb r0, [r5, #0]
     b42:   4060        eors r0, r4
     b44:   7028        strb r0, [r5, #0]
     b46:   0864        lsrs r4, r4, #1
     b48:   1e76        subs r6, r6, #1
     b4a:   b2f6        uxtb r6, r6
     b4c:   d2e7        bcs.n 0xb1e
     b4e:   1e7f        subs r7, r7, #1
     b50:   b2ff        uxtb r7, r7
     b52:   d2d6        bcs.n 0xb02
     b54:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
     b58:   00ce        lsls r6, r1, #3
     b5a:   2000        movs r0, #0
     b5c:   b570        push {r4, r5, r6, lr}
     b5e:   2402        movs r4, #2
     b60:   4d0d        ldr r5, [pc, #52]    ; (0xb98)
     b62:   f44f 76fa   mov.w r6, #500    ; 0x1f4
     b66:   f000 fde7   bl 0x1738
     b6a:   210a        movs r1, #10
     b6c:   e003        b.n 0xb76
     b6e:   eb01 0041   add.w r0, r1, r1, lsl #1
     b72:   5c28        ldrb r0, [r5, r0]
     b74:   b910        cbnz r0, 0xb7c
     b76:   1e49        subs r1, r1, #1
     b78:   b2c9        uxtb r1, r1
     b7a:   d2f8        bcs.n 0xb6e
     b7c:   29ff        cmp r1, #255    ; 0xff
     b7e:   d002        beq.n 0xb86
     b80:   2c00        cmp r4, #0
     b82:   d1f0        bne.n 0xb66
     b84:   bd70        pop {r4, r5, r6, pc}
     b86:   1e64        subs r4, r4, #1
     b88:   f014 04ff   ands.w r4, r4, #255    ; 0xff
     b8c:   d0fa        beq.n 0xb84
     b8e:   4630        mov r0, r6
     b90:   f7ff fab7   bl 0x102
     b94:   e7e7        b.n 0xb66
     b96:   0000        movs r0, r0
     b98:   00ce        lsls r6, r1, #3
     b9a:   2000        movs r0, #0
     b9c:   4904        ldr r1, [pc, #16]    ; (0xbb0)
     b9e:   7808        ldrb r0, [r1, #0]
     ba0:   1c40        adds r0, r0, #1
     ba2:   7008        strb r0, [r1, #0]
     ba4:   0780        lsls r0, r0, #30
     ba6:   d101        bne.n 0xbac
     ba8:   f000 bdc6   b.w 0x1738
     bac:   4770        bx lr
     bae:   0000        movs r0, r0
     bb0:   000c        movs r4, r1
     bb2:   2000        movs r0, #0
     bb4:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
     bb8:   2600        movs r6, #0
     bba:   4631        mov r1, r6
     bbc:   f44f 2070   mov.w r0, #983040    ; 0xf0000
     bc0:   2301        movs r3, #1
     bc2:   4632        mov r2, r6
     bc4:   f7ff fb82   bl 0x2cc                ; call ckcu_clocks_enable
     bc8:   2408        movs r4, #8
     bca:   e017        b.n 0xbfc
     bcc:   4824        ldr r0, [pc, #144]    ; (0xc60)
     bce:   2200        movs r2, #0
     bd0:   eb00 01c4   add.w r1, r0, r4, lsl #3
     bd4:   888d        ldrh r5, [r1, #4]
     bd6:   6808        ldr r0, [r1, #0]
     bd8:   b2a9        uxth r1, r5
     bda:   4607        mov r7, r0
     bdc:   f7ff fbf0   bl 0x3c0
     be0:   b2a9        uxth r1, r5
     be2:   4638        mov r0, r7
     be4:   2201        movs r2, #1
     be6:   f7ff fbdb   bl 0x3a0
     bea:   481d        ldr r0, [pc, #116]    ; (0xc60)
     bec:   3040        adds r0, #64    ; 0x40
     bee:   f810 1014   ldrb.w r1, [r0, r4, lsl #1]
     bf2:   eb00 0044   add.w r0, r0, r4, lsl #1
     bf6:   7840        ldrb r0, [r0, #1]
     bf8:   f7ff fa58   bl 0xac
     bfc:   1e64        subs r4, r4, #1
     bfe:   b2e4        uxtb r4, r4
     c00:   d2e4        bcs.n 0xbcc
     c02:   240a        movs r4, #10
     c04:   e013        b.n 0xc2e
     c06:   4816        ldr r0, [pc, #88]    ; (0xc60)
     c08:   3050        adds r0, #80    ; 0x50
     c0a:   eb00 01c4   add.w r1, r0, r4, lsl #3
     c0e:   888d        ldrh r5, [r1, #4]
     c10:   680f        ldr r7, [r1, #0]
     c12:   b2a9        uxth r1, r5
     c14:   4638        mov r0, r7
     c16:   f7ff fa63   bl 0xe0
     c1a:   b2a9        uxth r1, r5
     c1c:   4638        mov r0, r7
     c1e:   2200        movs r2, #0
     c20:   f7ff fbc6   bl 0x3b0
     c24:   b2a9        uxth r1, r5
     c26:   4638        mov r0, r7
     c28:   2201        movs r2, #1
     c2a:   f7ff fbb1   bl 0x390
     c2e:   1e64        subs r4, r4, #1
     c30:   b2e4        uxtb r4, r4
     c32:   d2e8        bcs.n 0xc06
     c34:   22ff        movs r2, #255    ; 0xff
     c36:   210a        movs r1, #10
     c38:   480a        ldr r0, [pc, #40]    ; (0xc64)
     c3a:   f7ff fa13   bl 0x64
     c3e:   4809        ldr r0, [pc, #36]    ; (0xc64)
     c40:   210a        movs r1, #10
     c42:   300a        adds r0, #10
     c44:   22ff        movs r2, #255    ; 0xff
     c46:   e005        b.n 0xc54
     c48:   f800 6b01   strb.w r6, [r0], #1
     c4c:   f800 2b01   strb.w r2, [r0], #1
     c50:   f800 2b01   strb.w r2, [r0], #1
     c54:   1e49        subs r1, r1, #1
     c56:   b2c9        uxtb r1, r1
     c58:   d2f6        bcs.n 0xc48
     c5a:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
     c5e:   0000        movs r0, r0
     c60:   1fd4        subs r4, r2, #7
     c62:   0000        movs r0, r0
     c64:   00c4        lsls r4, r0, #3
     c66:   2000        movs r0, #0
     c68:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
     c6c:   0007        movs r7, r0
     c6e:   f04f 040a   mov.w r4, #10
     c72:   d003        beq.n 0xc7c
     c74:   2000        movs r0, #0
     c76:   4680        mov r8, r0
     c78:   4d14        ldr r5, [pc, #80]    ; (0xccc)
     c7a:   e011        b.n 0xca0
     c7c:   2001        movs r0, #1
     c7e:   e7fa        b.n 0xc76
     c80:   eb05 06c4   add.w r6, r5, r4, lsl #3
     c84:   4642        mov r2, r8
     c86:   88b0        ldrh r0, [r6, #4]
     c88:   b281        uxth r1, r0
     c8a:   f855 0034   ldr.w r0, [r5, r4, lsl #3]
     c8e:   f7ff fbab   bl 0x3e8
     c92:   88b0        ldrh r0, [r6, #4]
     c94:   2201        movs r2, #1
     c96:   b281        uxth r1, r0
     c98:   f855 0034   ldr.w r0, [r5, r4, lsl #3]
     c9c:   f7ff fb78   bl 0x390
     ca0:   1e64        subs r4, r4, #1
     ca2:   b2e4        uxtb r4, r4
     ca4:   d2ec        bcs.n 0xc80
     ca6:   b147        cbz r7, 0xcba
     ca8:   2200        movs r2, #0
     caa:   4c09        ldr r4, [pc, #36]    ; (0xcd0)
     cac:   2110        movs r1, #16
     cae:   4620        mov r0, r4
     cb0:   f7ff fb7e   bl 0x3b0
     cb4:   b11f        cbz r7, 0xcbe
     cb6:   2201        movs r2, #1
     cb8:   e002        b.n 0xcc0
     cba:   2201        movs r2, #1
     cbc:   e7f5        b.n 0xcaa
     cbe:   2200        movs r2, #0
     cc0:   4620        mov r0, r4
     cc2:   e8bd 41f0   ldmia.w sp!, {r4, r5, r6, r7, r8, lr}
     cc6:   2110        movs r1, #16
     cc8:   f7ff bb8e   b.w 0x3e8
     ccc:   2024        movs r0, #36    ; 0x24
     cce:   0000        movs r0, r0
     cd0:   0000        movs r0, r0
     cd2:   400b        ands r3, r1
     cd4:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
     cd8:   2100        movs r1, #0
     cda:   f44f 3200   mov.w r2, #131072    ; 0x20000
     cde:   f44f 20e0   mov.w r0, #458752    ; 0x70000
     ce2:   2301        movs r3, #1
     ce4:   f7ff faf2   bl 0x2cc                ; call ckcu_clocks_enable
     ce8:   f64e 2160   movw r1, #60000    ; 0xea60
     cec:   4824        ldr r0, [pc, #144]    ; (0xd80)
     cee:   f7ff f9a3   bl 0x38
     cf2:   4c24        ldr r4, [pc, #144]    ; (0xd84)
     cf4:   2102        movs r1, #2
     cf6:   4620        mov r0, r4
     cf8:   f7ff f9f2   bl 0xe0
     cfc:   2201        movs r2, #1
     cfe:   2102        movs r1, #2
     d00:   4620        mov r0, r4
     d02:   f7ff fb55   bl 0x3b0
     d06:   2201        movs r2, #1
     d08:   2102        movs r1, #2
     d0a:   4620        mov r0, r4
     d0c:   f7ff fb40   bl 0x390
     d10:   2104        movs r1, #4
     d12:   4620        mov r0, r4
     d14:   f7ff f9e4   bl 0xe0
     d18:   4e1b        ldr r6, [pc, #108]    ; (0xd88)
     d1a:   f44f 4580   mov.w r5, #16384    ; 0x4000
     d1e:   4629        mov r1, r5
     d20:   4630        mov r0, r6
     d22:   f7ff f9dd   bl 0xe0
     d26:   006f        lsls r7, r5, #1
     d28:   4639        mov r1, r7
     d2a:   4630        mov r0, r6
     d2c:   f7ff f9d8   bl 0xe0
     d30:   2201        movs r2, #1
     d32:   2104        movs r1, #4
     d34:   4620        mov r0, r4
     d36:   f7ff fb3b   bl 0x3b0
     d3a:   2201        movs r2, #1
     d3c:   4629        mov r1, r5
     d3e:   4630        mov r0, r6
     d40:   f7ff fb36   bl 0x3b0
     d44:   2201        movs r2, #1
     d46:   4639        mov r1, r7
     d48:   4630        mov r0, r6
     d4a:   f7ff fb31   bl 0x3b0
     d4e:   2201        movs r2, #1
     d50:   2104        movs r1, #4
     d52:   4620        mov r0, r4
     d54:   f7ff fb1c   bl 0x390
     d58:   2201        movs r2, #1
     d5a:   4629        mov r1, r5
     d5c:   4630        mov r0, r6
     d5e:   f7ff fb17   bl 0x390
     d62:   2201        movs r2, #1
     d64:   4639        mov r1, r7
     d66:   4630        mov r0, r6
     d68:   f7ff fb12   bl 0x390
     d6c:   2201        movs r2, #1
     d6e:   4611        mov r1, r2
     d70:   4806        ldr r0, [pc, #24]    ; (0xd8c)
     d72:   f7ff fb15   bl 0x3a0
     d76:   e8bd 41f0   ldmia.w sp!, {r4, r5, r6, r7, r8, lr}
     d7a:   f000 bd39   b.w 0x17f0
     d7e:   0000        movs r0, r0
     d80:   7000        strb r0, [r0, #0]
     d82:   4007        ands r7, r0
     d84:   4000        ands r0, r0
     d86:   400b        ands r3, r1
     d88:   0000        movs r0, r0
     d8a:   400b        ands r3, r1
     d8c:   2000        movs r0, #0
     d8e:   400b        ands r3, r1
     d90:   b570        push {r4, r5, r6, lr}
     d92:   4c18        ldr r4, [pc, #96]    ; (0xdf4)

     d94:   2100        movs r1, #0
     d96:   4620        mov r0, r4
     d98:   f7ff fa1e   bl 0x1d8            ; call bftm_set_mien(BFTM1, 0)

     d9c:   2100        movs r1, #0
     d9e:   4620        mov r0, r4
     da0:   f7ff fa10   bl 0x1c4            ; call bftm_set_cen(BFTM1, 0)

     da4:   4620        mov r0, r4
     da6:   f7ff f9a5   bl 0xf4             ; call bftm_clear(BFTM1)

     daa:   4913        ldr r1, [pc, #76]    ; (0xdf8)
     dac:   1520        asrs r0, r4, #20
     dae:   f8c1 0180   str.w r0, [r1, #384]    ; 0x180
     db2:   2100        movs r1, #0
     db4:   4811        ldr r0, [pc, #68]    ; (0xdfc)
     db6:   f7ff fb45   bl 0x444
     dba:   4911        ldr r1, [pc, #68]    ; (0xe00)
     dbc:   2002        movs r0, #2
     dbe:   6248        str r0, [r1, #36]    ; 0x24
     dc0:   4c10        ldr r4, [pc, #64]    ; (0xe04)
     dc2:   2508        movs r5, #8
     dc4:   e012        b.n 0xdec
     dc6:   88a0        ldrh r0, [r4, #4]
     dc8:   2200        movs r2, #0
     dca:   b281        uxth r1, r0
     dcc:   6820        ldr r0, [r4, #0]
     dce:   f7ff fadf   bl 0x390
     dd2:   88a0        ldrh r0, [r4, #4]
     dd4:   2201        movs r2, #1
     dd6:   b281        uxth r1, r0
     dd8:   6820        ldr r0, [r4, #0]
     dda:   f7ff fae1   bl 0x3a0
     dde:   88a0        ldrh r0, [r4, #4]
     de0:   2202        movs r2, #2
     de2:   b281        uxth r1, r0
     de4:   6820        ldr r0, [r4, #0]
     de6:   f7ff faeb   bl 0x3c0
     dea:   3408        adds r4, #8
     dec:   1e6d        subs r5, r5, #1
     dee:   b2ed        uxtb r5, r5
     df0:   d2e9        bcs.n 0xdc6
     df2:   bd70        pop {r4, r5, r6, pc}

   0xdf4:   0x40077000  ; BFTM1
   0xdf8:   0xe000e004

   0xdfc:   0x4006f000
   0xe00:   0x400b4000
   0xe04:   0x2074

   0xe08:   b570        push {r4, r5, r6, lr}
     e0a:   4c23        ldr r4, [pc, #140]    ; (0xe98)
     e0c:   2508        movs r5, #8
     e0e:   e011        b.n 0xe34
     e10:   88a0        ldrh r0, [r4, #4]
     e12:   b281        uxth r1, r0
     e14:   6820        ldr r0, [r4, #0]
     e16:   f7ff f963   bl 0xe0
     e1a:   88a0        ldrh r0, [r4, #4]
     e1c:   2201        movs r2, #1
     e1e:   b281        uxth r1, r0
     e20:   6820        ldr r0, [r4, #0]
     e22:   f7ff fac5   bl 0x3b0
     e26:   88a0        ldrh r0, [r4, #4]
     e28:   2201        movs r2, #1
     e2a:   b281        uxth r1, r0
     e2c:   6820        ldr r0, [r4, #0]
     e2e:   f7ff faaf   bl 0x390
     e32:   3408        adds r4, #8
     e34:   1e6d        subs r5, r5, #1
     e36:   b2ed        uxtb r5, r5
     e38:   d2ea        bcs.n 0xe10
     e3a:   4918        ldr r1, [pc, #96]    ; (0xe9c)
     e3c:   2002        movs r0, #2
     e3e:   6288        str r0, [r1, #40]    ; 0x28
     e40:   0201        lsls r1, r0, #8
     e42:   4817        ldr r0, [pc, #92]    ; (0xea0)
     e44:   f7ff f915   bl 0x72
     e48:   4916        ldr r1, [pc, #88]    ; (0xea4)
     e4a:   2000        movs r0, #0
     e4c:   7048        strb r0, [r1, #1]
     e4e:   2064        movs r0, #100    ; 0x64
     e50:   f7ff f957   bl 0x102
     e54:   f000 f854   bl 0xf00
     e58:   2002        movs r0, #2
     e5a:   f000 fcf3   bl 0x1844
     e5e:   4912        ldr r1, [pc, #72]    ; (0xea8)
     e60:   f44f 4000   mov.w r0, #32768    ; 0x8000
     e64:   6248        str r0, [r1, #36]    ; 0x24
     e66:   2101        movs r1, #1
     e68:   4810        ldr r0, [pc, #64]    ; (0xeac)
     e6a:   f7ff faeb   bl 0x444
     e6e:   4c10        ldr r4, [pc, #64]    ; (0xeb0)

     e70:   2100        movs r1, #0
     e72:   4620        mov r0, r4
     e74:   f7ff f930   bl 0xd8             ; call bftm_set_counter(BFTM1, 0)

     e78:   4620        mov r0, r4
     e7a:   f7ff f93b   bl 0xf4             ; call bftm_clear(BFTM1)

     e7e:   2101        movs r1, #1
     e80:   4620        mov r0, r4
     e82:   f7ff f99f   bl 0x1c4            ; call bftm_set_cen(BFTM1, 1)

     e86:   2101        movs r1, #1
     e88:   4620        mov r0, r4
     e8a:   f7ff f9a5   bl 0x1d8            ; call bftm_set_mien(BFTM1, 1)

     e8e:   4909        ldr r1, [pc, #36]    ; (0xeb4)
     e90:   1520        asrs r0, r4, #20
     e92:   f8c1 0100   str.w r0, [r1, #256]    ; 0x100
     e96:   bd70        pop {r4, r5, r6, pc}

     e98:   0x2074        movs r0, #116    ; 0x74

   0xe9c:   0x400b4000  ; GPIO C
   0xea0:   0x200000ec
   0xea4:   0x20000010
   0xea8:   0x400b0000  ; GPIO A
   0xeac:   0x4006f000  ; GPTM1
   0xeb0:   0x40077000  ; BFTM1

     eb4:   e004        b.n 0xec0
     eb6:   e000        b.n 0xeba
     eb8:   b530        push {r4, r5, lr}
     eba:   2012        movs r0, #18
     ebc:   f000 fcc2   bl 0x1844
     ec0:   210a        movs r1, #10
     ec2:   f44f 7040   mov.w r0, #768    ; 0x300
     ec6:   f000 fcd5   bl 0x1874
     eca:   2102        movs r1, #2
     ecc:   2000        movs r0, #0
     ece:   f000 fcd1   bl 0x1874
     ed2:   4c09        ldr r4, [pc, #36]    ; (0xef8)
     ed4:   f44f 4080   mov.w r0, #16384    ; 0x4000
     ed8:   62a0        str r0, [r4, #40]    ; 0x28
     eda:   0045        lsls r5, r0, #1
     edc:   6265        str r5, [r4, #36]    ; 0x24
     ede:   2108        movs r1, #8
     ee0:   f44f 6040   mov.w r0, #3072    ; 0xc00
     ee4:   f000 fcc6   bl 0x1874
     ee8:   4904        ldr r1, [pc, #16]    ; (0xefc)
     eea:   2004        movs r0, #4
     eec:   6248        str r0, [r1, #36]    ; 0x24
     eee:   62a5        str r5, [r4, #40]    ; 0x28
     ef0:   bf00        nop
     ef2:   bf00        nop
     ef4:   6265        str r5, [r4, #36]    ; 0x24
     ef6:   bd30        pop {r4, r5, pc}
     ef8:   0000        movs r0, r0
     efa:   400b        ands r3, r1
     efc:   4000        ands r0, r0
     efe:   400b        ands r3, r1
     f00:   e92d 4ff0   stmdb sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
     f04:   491e        ldr r1, [pc, #120]    ; (0xf80)
     f06:   481d        ldr r0, [pc, #116]    ; (0xf7c)
     f08:   2510        movs r5, #16
     f0a:   784a        ldrb r2, [r1, #1]
     f0c:   2704        movs r7, #4
     f0e:   eb00 1482   add.w r4, r0, r2, lsl #6
     f12:   7808        ldrb r0, [r1, #0]
     f14:   f8df a06c   ldr.w sl, [pc, #108]    ; 0xf84
     f18:   4e1b        ldr r6, [pc, #108]    ; (0xf88)
     f1a:   f44f 4b80   mov.w fp, #16384    ; 0x4000
     f1e:   343e        adds r4, #62    ; 0x3e
     f20:   b130        cbz r0, 0xf30
     f22:   1e40        subs r0, r0, #1
     f24:   f010 00ff   ands.w r0, r0, #255    ; 0xff
     f28:   7008        strb r0, [r1, #0]
     f2a:   d101        bne.n 0xf30
     f2c:   f7ff ffc4   bl 0xeb8
     f30:   46b9        mov r9, r7
     f32:   1e6d        subs r5, r5, #1
     f34:   b2ed        uxtb r5, r5
     f36:   d31c        bcc.n 0xf72
     f38:   f44f 4800   mov.w r8, #32768    ; 0x8000
     f3c:   f8c6 8028   str.w r8, [r6, #40]    ; 0x28
     f40:   8820        ldrh r0, [r4, #0]
     f42:   1ea7        subs r7, r4, #2
     f44:   210a        movs r1, #10
     f46:   f000 fc95   bl 0x1874
     f4a:   8838        ldrh r0, [r7, #0]
     f4c:   2109        movs r1, #9
     f4e:   f3c0 1780   ubfx r7, r0, #6, #1
     f52:   1f24        subs r4, r4, #4
     f54:   f000 fc8e   bl 0x1874
     f58:   4658        mov r0, fp
     f5a:   f8c6 b028   str.w fp, [r6, #40]    ; 0x28
     f5e:   f8c6 8024   str.w r8, [r6, #36]    ; 0x24
     f62:   4649        mov r1, r9
     f64:   4652        mov r2, sl
     f66:   b10f        cbz r7, 0xf6c
     f68:   6251        str r1, [r2, #36]    ; 0x24
     f6a:   e000        b.n 0xf6e
     f6c:   6291        str r1, [r2, #40]    ; 0x28
     f6e:   6270        str r0, [r6, #36]    ; 0x24
     f70:   e7df        b.n 0xf32
     f72:   f8ca 9024   str.w r9, [sl, #36]    ; 0x24
     f76:   e8bd 8ff0   ldmia.w sp!, {r4, r5, r6, r7, r8, r9, sl, fp, pc}
     f7a:   0000        movs r0, r0
     f7c:   00ec        lsls r4, r5, #3
     f7e:   2000        movs r0, #0
     f80:   0010        movs r0, r2
     f82:   2000        movs r0, #0
     f84:   4000        ands r0, r0
     f86:   400b        ands r3, r1
     f88:   0000        movs r0, r0
     f8a:   400b        ands r3, r1
     f8c:   4814        ldr r0, [pc, #80]    ; (0xfe0)
     f8e:   2101        movs r1, #1
     f90:   f8c0 1300   str.w r1, [r0, #768]    ; 0x300
     f94:   4a13        ldr r2, [pc, #76]    ; (0xfe4)
     f96:   f8c2 10a8   str.w r1, [r2, #168]    ; 0xa8
     f9a:   f8d2 3108   ldr.w r3, [r2, #264]    ; 0x108
     f9e:   2b00        cmp r3, #0
     fa0:   d0fb        beq.n 0xf9a
     fa2:   2300        movs r3, #0
     fa4:   6213        str r3, [r2, #32]
     fa6:   f04f 6310   mov.w r3, #150994944    ; 0x9000000
     faa:   6183        str r3, [r0, #24]
     fac:   f8c2 10a4   str.w r1, [r2, #164]    ; 0xa4
     fb0:   f8d2 3104   ldr.w r3, [r2, #260]    ; 0x104
     fb4:   2b00        cmp r3, #0
     fb6:   d0fb        beq.n 0xfb0
     fb8:   4a0b        ldr r2, [pc, #44]    ; (0xfe8)
     fba:   f8d2 3200   ldr.w r3, [r2, #512]    ; 0x200
     fbe:   f023 0307   bic.w r3, r3, #7
     fc2:   1cdb        adds r3, r3, #3
     fc4:   f8c2 3200   str.w r3, [r2, #512]    ; 0x200
     fc8:   6201        str r1, [r0, #32]
     fca:   6842        ldr r2, [r0, #4]
     fcc:   f022 0203   bic.w r2, r2, #3
     fd0:   1c52        adds r2, r2, #1
     fd2:   6042        str r2, [r0, #4]
     fd4:   6b42        ldr r2, [r0, #52]    ; 0x34
     fd6:   ebb1 7f92   cmp.w r1, r2, lsr #30
     fda:   d1fb        bne.n 0xfd4
     fdc:   4770        bx lr
     fde:   0000        movs r0, r0

     fe0:   0x40088000
     fe4:   0x43100000
     fe8:   0x40080000

     fec:   4804        ldr r0, [pc, #16]    ; (0x1000)
     fee:   2100        movs r1, #0
     ff0:   f100 0208   add.w r2, r0, #8
     ff4:   61c1        str r1, [r0, #28]
     ff6:   6201        str r1, [r0, #32]
     ff8:   7051        strb r1, [r2, #1]
     ffa:   f8c0 1015   str.w r1, [r0, #21]
     ffe:   4770        bx lr
    1000:   001c        movs r4, r3
    1002:   2000        movs r0, #0
    1004:   4806        ldr r0, [pc, #24]    ; (0x1020)
    1006:   b500        push {lr}
    1008:   4905        ldr r1, [pc, #20]    ; (0x1020)
    100a:   2301        movs r3, #1
    100c:   7003        strb r3, [r0, #0]
    100e:   310c        adds r1, #12
    1010:   2002        movs r0, #2
    1012:   7008        strb r0, [r1, #0]
    1014:   f7ff ffea   bl 0xfec
    1018:   4801        ldr r0, [pc, #4]    ; (0x1020)
    101a:   3808        subs r0, #8
    101c:   7103        strb r3, [r0, #4]
    101e:   bd00        pop {pc}
    1020:   0024        movs r4, r4
    1022:   2000        movs r0, #0
    1024:   f890 0034   ldrb.w r0, [r0, #52]    ; 0x34
    1028:   f3c0 0040   ubfx r0, r0, #1, #1
    102c:   4770        bx lr
    102e:   0000        movs r0, r0
    1030:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
    1034:   4604        mov r4, r0
    1036:   f000 fa1d   bl 0x1474
    103a:   4605        mov r5, r0
    103c:   4e56        ldr r6, [pc, #344]    ; (0x1198)
    103e:   0780        lsls r0, r0, #30
    1040:   d505        bpl.n 0x104e
    1042:   6870        ldr r0, [r6, #4]
    1044:   b100        cbz r0, 0x1048
    1046:   4780        blx r0
    1048:   2002        movs r0, #2
    104a:   f000 f8c1   bl 0x11d0
    104e:   06e8        lsls r0, r5, #27
    1050:   d50f        bpl.n 0x1072
    1052:   2010        movs r0, #16
    1054:   f000 f8bc   bl 0x11d0
    1058:   f894 0032   ldrb.w r0, [r4, #50]    ; 0x32
    105c:   2802        cmp r0, #2
    105e:   d308        bcc.n 0x1072
    1060:   f000 fa10   bl 0x1484
    1064:   f894 0032   ldrb.w r0, [r4, #50]    ; 0x32
    1068:   f884 0033   strb.w r0, [r4, #51]    ; 0x33
    106c:   2003        movs r0, #3
    106e:   f884 0032   strb.w r0, [r4, #50]    ; 0x32
    1072:   0768        lsls r0, r5, #29
    1074:   f04f 0700   mov.w r7, #0
    1078:   d521        bpl.n 0x10be
    107a:   1e78        subs r0, r7, #1
    107c:   6220        str r0, [r4, #32]
    107e:   f884 7030   strb.w r7, [r4, #48]    ; 0x30
    1082:   f884 7031   strb.w r7, [r4, #49]    ; 0x31
    1086:   f894 0034   ldrb.w r0, [r4, #52]    ; 0x34
    108a:   f020 0002   bic.w r0, r0, #2
    108e:   f884 0034   strb.w r0, [r4, #52]    ; 0x34
    1092:   2004        movs r0, #4
    1094:   f884 0032   strb.w r0, [r4, #50]    ; 0x32
    1098:   63a7        str r7, [r4, #56]    ; 0x38
    109a:   f000 f8f1   bl 0x1280
    109e:   f000 f9f9   bl 0x1494
    10a2:   493e        ldr r1, [pc, #248]    ; (0x119c)
    10a4:   2000        movs r0, #0
    10a6:   f000 f949   bl 0x133c
    10aa:   483c        ldr r0, [pc, #240]    ; (0x119c)
    10ac:   6800        ldr r0, [r0, #0]
    10ae:   f000 f9c9   bl 0x1444
    10b2:   6830        ldr r0, [r6, #0]
    10b4:   b100        cbz r0, 0x10b8
    10b6:   4780        blx r0
    10b8:   2004        movs r0, #4
    10ba:   f000 f889   bl 0x11d0
    10be:   0728        lsls r0, r5, #28
    10c0:   d508        bpl.n 0x10d4
    10c2:   f000 f9e7   bl 0x1494
    10c6:   f894 0033   ldrb.w r0, [r4, #51]    ; 0x33
    10ca:   f884 0032   strb.w r0, [r4, #50]    ; 0x32
    10ce:   2008        movs r0, #8
    10d0:   f000 f87e   bl 0x11d0
    10d4:   05e8        lsls r0, r5, #23
    10d6:   f44f 7880   mov.w r8, #256    ; 0x100
    10da:   d53d        bpl.n 0x1158
    10dc:   2000        movs r0, #0
    10de:   f000 f91d   bl 0x131c
    10e2:   4605        mov r5, r0
    10e4:   0580        lsls r0, r0, #22
    10e6:   d50a        bpl.n 0x10fe
    10e8:   4620        mov r0, r4
    10ea:   f000 fa63   bl 0x15b4
    10ee:   4620        mov r0, r4
    10f0:   f000 fd26   bl 0x1b40
    10f4:   f44f 7100   mov.w r1, #512    ; 0x200
    10f8:   2000        movs r0, #0
    10fa:   f000 f8d7   bl 0x12ac
    10fe:   07a8        lsls r0, r5, #30
    1100:   d51e        bpl.n 0x1140
    1102:   2102        movs r1, #2
    1104:   2000        movs r0, #0
    1106:   f000 f8d1   bl 0x12ac
    110a:   6a20        ldr r0, [r4, #32]
    110c:   1c40        adds r0, r0, #1
    110e:   d017        beq.n 0x1140
    1110:   f894 0024   ldrb.w r0, [r4, #36]    ; 0x24
    1114:   2802        cmp r0, #2
    1116:   d113        bne.n 0x1140
    1118:   2240        movs r2, #64    ; 0x40
    111a:   2000        movs r0, #0
    111c:   69e1        ldr r1, [r4, #28]
    111e:   f000 f93d   bl 0x139c
    1122:   69e1        ldr r1, [r4, #28]
    1124:   4401        add r1, r0
    1126:   61e1        str r1, [r4, #28]
    1128:   6a21        ldr r1, [r4, #32]
    112a:   1a08        subs r0, r1, r0
    112c:   6220        str r0, [r4, #32]
    112e:   d107        bne.n 0x1140
    1130:   2001        movs r0, #1
    1132:   f884 0024   strb.w r0, [r4, #36]    ; 0x24
    1136:   6aa1        ldr r1, [r4, #40]    ; 0x28
    1138:   b111        cbz r1, 0x1140
    113a:   6ae0        ldr r0, [r4, #44]    ; 0x2c
    113c:   4788        blx r1
    113e:   62a7        str r7, [r4, #40]    ; 0x28
    1140:   06e8        lsls r0, r5, #27
    1142:   d506        bpl.n 0x1152
    1144:   4620        mov r0, r4
    1146:   f000 fcd9   bl 0x1afc
    114a:   2110        movs r1, #16
    114c:   2000        movs r0, #0
    114e:   f000 f8ad   bl 0x12ac
    1152:   4640        mov r0, r8
    1154:   f000 f83c   bl 0x11d0
    1158:   4644        mov r4, r8
    115a:   f000 f98b   bl 0x1474
    115e:   f000 f979   bl 0x1454
    1162:   4605        mov r5, r0
    1164:   1c40        adds r0, r0, #1
    1166:   d014        beq.n 0x1192
    1168:   4628        mov r0, r5
    116a:   f000 f8d7   bl 0x131c
    116e:   f010 0f12   tst.w r0, #18
    1172:   d0f2        beq.n 0x115a
    1174:   2112        movs r1, #18
    1176:   4628        mov r0, r5
    1178:   f000 f898   bl 0x12ac
    117c:   fa04 f005   lsl.w r0, r4, r5
    1180:   f000 f826   bl 0x11d0
    1184:   69b0        ldr r0, [r6, #24]
    1186:   2800        cmp r0, #0
    1188:   d0e7        beq.n 0x115a
    118a:   4601        mov r1, r0
    118c:   4628        mov r0, r5
    118e:   4788        blx r1
    1190:   e7e3        b.n 0x115a
    1192:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
    1196:   0000        movs r0, r0
    1198:   2214        movs r2, #20
    119a:   0000        movs r0, r0
    119c:   0040        lsls r0, r0, #1
    119e:   2000        movs r0, #0
    11a0:   2102        movs r1, #2
    11a2:   f880 1032   strb.w r1, [r0, #50]    ; 0x32
    11a6:   4801        ldr r0, [pc, #4]    ; (0x11ac)
    11a8:   f7fe bfb2   b.w 0x110
    11ac:   0040        lsls r0, r0, #1
    11ae:   2000        movs r0, #0
    11b0:   f890 0032   ldrb.w r0, [r0, #50]    ; 0x32
    11b4:   2803        cmp r0, #3
    11b6:   d001        beq.n 0x11bc
    11b8:   2000        movs r0, #0
    11ba:   4770        bx lr
    11bc:   2001        movs r0, #1
    11be:   4770        bx lr
    11c0:   b510        push {r4, lr}
    11c2:   f000 f967   bl 0x1494
    11c6:   e8bd 4010   ldmia.w sp!, {r4, lr}
    11ca:   f000 b9fb   b.w 0x15c4
    11ce:   0000        movs r0, r0
    11d0:   4901        ldr r1, [pc, #4]    ; (0x11d8)
    11d2:   6088        str r0, [r1, #8]
    11d4:   4770        bx lr
    11d6:   0000        movs r0, r0
    11d8:   8000        strh r0, [r0, #0]
    11da:   400a        ands r2, r1
    11dc:   b510        push {r4, lr}
    11de:   2100        movs r1, #0
    11e0:   f44f 6080   mov.w r0, #1024    ; 0x400
    11e4:   2240        movs r2, #64    ; 0x40
    11e6:   2301        movs r3, #1
    11e8:   f7ff f870   bl 0x2cc                ; call ckcu_clocks_enable
    11ec:   2002        movs r0, #2
    11ee:   f7ff f87f   bl 0x2f0
    11f2:   4c12        ldr r4, [pc, #72]    ; (0x123c)
    11f4:   4810        ldr r0, [pc, #64]    ; (0x1238)
    11f6:   60a0        str r0, [r4, #8]
    11f8:   385c        subs r0, #92    ; 0x5c
    11fa:   60e0        str r0, [r4, #12]
    11fc:   38d4        subs r0, #212    ; 0xd4
    11fe:   6120        str r0, [r4, #16]
    1200:   2002        movs r0, #2
    1202:   6160        str r0, [r4, #20]
    1204:   f7ff fefe   bl 0x1004
    1208:   4620        mov r0, r4
    120a:   f7ff ffc9   bl 0x11a0
    120e:   490c        ldr r1, [pc, #48]    ; (0x1240)
    1210:   f44f 1000   mov.w r0, #2097152    ; 0x200000
    1214:   f8c1 0100   str.w r0, [r1, #256]    ; 0x100
    1218:   2001        movs r0, #1
    121a:   f000 f823   bl 0x1264
    121e:   20fa        movs r0, #250    ; 0xfa
    1220:   f7fe ff6f   bl 0x102
    1224:   f894 0034   ldrb.w r0, [r4, #52]    ; 0x34
    1228:   e8bd 4010   ldmia.w sp!, {r4, lr}
    122c:   f000 0101   and.w r1, r0, #1
    1230:   4804        ldr r0, [pc, #16]    ; (0x1244)
    1232:   f000 b937   b.w 0x14a4
    1236:   0000        movs r0, r0
    1238:   21e4        movs r1, #228    ; 0xe4
    123a:   0000        movs r0, r0
    123c:   0304        lsls r4, r0, #12
    123e:   2000        movs r0, #0
    1240:   e004        b.n 0x124c
    1242:   e000        b.n 0x1246
    1244:   0040        lsls r0, r0, #1
    1246:   2000        movs r0, #0
    1248:   4905        ldr r1, [pc, #20]    ; (0x1260)
    124a:   2801        cmp r0, #1
    124c:   6808        ldr r0, [r1, #0]
    124e:   d003        beq.n 0x1258
    1250:   f420 6000   bic.w r0, r0, #2048    ; 0x800
    1254:   6008        str r0, [r1, #0]
    1256:   4770        bx lr
    1258:   f440 6000   orr.w r0, r0, #2048    ; 0x800
    125c:   e7fa        b.n 0x1254
    125e:   0000        movs r0, r0
    1260:   8000        strh r0, [r0, #0]
    1262:   400a        ands r2, r1
    1264:   4905        ldr r1, [pc, #20]    ; (0x127c)
    1266:   2801        cmp r0, #1
    1268:   6808        ldr r0, [r1, #0]
    126a:   d003        beq.n 0x1274
    126c:   f420 6080   bic.w r0, r0, #1024    ; 0x400
    1270:   6008        str r0, [r1, #0]
    1272:   4770        bx lr
    1274:   f440 6080   orr.w r0, r0, #1024    ; 0x400
    1278:   e7fa        b.n 0x1270
    127a:   0000        movs r0, r0
    127c:   8000        strh r0, [r0, #0]
    127e:   400a        ands r2, r1
    1280:   2100        movs r1, #0
    1282:   2020        movs r0, #32
    1284:   2301        movs r3, #1
    1286:   460a        mov r2, r1
    1288:   f7ff bc0a   b.w 0xaa0
    128c:   b510        push {r4, lr}
    128e:   f000 fd69   bl 0x1d64
    1292:   6801        ldr r1, [r0, #0]
    1294:   f001 0109   and.w r1, r1, #9
    1298:   6001        str r1, [r0, #0]
    129a:   bd10        pop {r4, pc}
    129c:   b510        push {r4, lr}
    129e:   f000 fd61   bl 0x1d64
    12a2:   6801        ldr r1, [r0, #0]
    12a4:   f001 0124   and.w r1, r1, #36    ; 0x24
    12a8:   6001        str r1, [r0, #0]
    12aa:   bd10        pop {r4, pc}
    12ac:   b510        push {r4, lr}
    12ae:   460c        mov r4, r1
    12b0:   f000 fd58   bl 0x1d64
    12b4:   6084        str r4, [r0, #8]
    12b6:   bd10        pop {r4, pc}
    12b8:   b510        push {r4, lr}
    12ba:   f000 fd53   bl 0x1d64
    12be:   6900        ldr r0, [r0, #16]
    12c0:   4902        ldr r1, [pc, #8]    ; (0x12cc)
    12c2:   f3c0 0009   ubfx r0, r0, #0, #10
    12c6:   4408        add r0, r1
    12c8:   bd10        pop {r4, pc}
    12ca:   0000        movs r0, r0
    12cc:   a000        add r0, pc, #0    ; (adr r0, 0x12d0)
    12ce:   400a        ands r2, r1
    12d0:   b570        push {r4, r5, r6, lr}
    12d2:   4605        mov r5, r0
    12d4:   f000 fd46   bl 0x1d64
    12d8:   4604        mov r4, r0
    12da:   4628        mov r0, r5
    12dc:   f000 f80a   bl 0x12f4
    12e0:   6921        ldr r1, [r4, #16]
    12e2:   f3c1 0109   ubfx r1, r1, #0, #10
    12e6:   4408        add r0, r1
    12e8:   4901        ldr r1, [pc, #4]    ; (0x12f0)
    12ea:   4408        add r0, r1
    12ec:   bd70        pop {r4, r5, r6, pc}
    12ee:   0000        movs r0, r0
    12f0:   a000        add r0, pc, #0    ; (adr r0, 0x12f4)
    12f2:   400a        ands r2, r1
    12f4:   b510        push {r4, lr}
    12f6:   f000 fd35   bl 0x1d64
    12fa:   6900        ldr r0, [r0, #16]
    12fc:   f3c0 2089   ubfx r0, r0, #10, #10
    1300:   bd10        pop {r4, pc}
    1302:   b510        push {r4, lr}
    1304:   f000 fd2e   bl 0x1d64
    1308:   6901        ldr r1, [r0, #16]
    130a:   6800        ldr r0, [r0, #0]
    130c:   00c9        lsls r1, r1, #3
    130e:   d502        bpl.n 0x1316
    1310:   f3c0 0080   ubfx r0, r0, #2, #1
    1314:   bd10        pop {r4, pc}
    1316:   f3c0 1040   ubfx r0, r0, #5, #1
    131a:   bd10        pop {r4, pc}
    131c:   b510        push {r4, lr}
    131e:   f000 fd21   bl 0x1d64
    1322:   6841        ldr r1, [r0, #4]
    1324:   6880        ldr r0, [r0, #8]
    1326:   4008        ands r0, r1
    1328:   bd10        pop {r4, pc}
    132a:   b510        push {r4, lr}
    132c:   460c        mov r4, r1
    132e:   f000 fd19   bl 0x1d64
    1332:   68c0        ldr r0, [r0, #12]
    1334:   40e0        lsrs r0, r4
    1336:   f3c0 0008   ubfx r0, r0, #0, #9
    133a:   bd10        pop {r4, pc}
    133c:   b570        push {r4, r5, r6, lr}
    133e:   460c        mov r4, r1
    1340:   4605        mov r5, r0
    1342:   f000 fd0f   bl 0x1d64
    1346:   eb04 01c5   add.w r1, r4, r5, lsl #3
    134a:   684a        ldr r2, [r1, #4]
    134c:   6102        str r2, [r0, #16]
    134e:   6889        ldr r1, [r1, #8]
    1350:   6041        str r1, [r0, #4]
    1352:   f04f 31ff   mov.w r1, #4294967295    ; 0xffffffff
    1356:   6081        str r1, [r0, #8]
    1358:   4628        mov r0, r5
    135a:   e8bd 4070   ldmia.w sp!, {r4, r5, r6, lr}
    135e:   f000 b835   b.w 0x13cc
    1362:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
    1366:   4616        mov r6, r2
    1368:   460f        mov r7, r1
    136a:   0005        movs r5, r0
    136c:   d011        beq.n 0x1392
    136e:   2100        movs r1, #0
    1370:   f7ff ffdb   bl 0x132a
    1374:   4604        mov r4, r0
    1376:   42b0        cmp r0, r6
    1378:   d808        bhi.n 0x138c
    137a:   4628        mov r0, r5
    137c:   b15d        cbz r5, 0x1396
    137e:   f7ff ff9b   bl 0x12b8
    1382:   1ce1        adds r1, r4, #3
    1384:   088a        lsrs r2, r1, #2
    1386:   4639        mov r1, r7
    1388:   f000 fce4   bl 0x1d54
    138c:   4620        mov r0, r4
    138e:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
    1392:   2110        movs r1, #16
    1394:   e7ec        b.n 0x1370
    1396:   f7ff ff9b   bl 0x12d0
    139a:   e7f2        b.n 0x1382
    139c:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
    13a0:   4615        mov r5, r2
    13a2:   460e        mov r6, r1
    13a4:   4607        mov r7, r0
    13a6:   f000 fcdd   bl 0x1d64
    13aa:   4604        mov r4, r0
    13ac:   2000        movs r0, #0
    13ae:   b13d        cbz r5, 0x13c0
    13b0:   462a        mov r2, r5
    13b2:   4631        mov r1, r6
    13b4:   4638        mov r0, r7
    13b6:   f7ff ffd4   bl 0x1362
    13ba:   b908        cbnz r0, 0x13c0
    13bc:   2d00        cmp r5, #0
    13be:   d103        bne.n 0x13c8
    13c0:   6821        ldr r1, [r4, #0]
    13c2:   f001 0110   and.w r1, r1, #16
    13c6:   6021        str r1, [r4, #0]
    13c8:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
    13cc:   b510        push {r4, lr}
    13ce:   f000 fcc9   bl 0x1d64
    13d2:   6801        ldr r1, [r0, #0]
    13d4:   f001 0119   and.w r1, r1, #25
    13d8:   6001        str r1, [r0, #0]
    13da:   bd10        pop {r4, pc}
    13dc:   b510        push {r4, lr}
    13de:   f000 fcc1   bl 0x1d64
    13e2:   2104        movs r1, #4
    13e4:   6001        str r1, [r0, #0]
    13e6:   bd10        pop {r4, pc}
    13e8:   b510        push {r4, lr}
    13ea:   f000 fcbb   bl 0x1d64
    13ee:   2140        movs r1, #64    ; 0x40
    13f0:   6081        str r1, [r0, #8]
    13f2:   6802        ldr r2, [r0, #0]
    13f4:   2124        movs r1, #36    ; 0x24
    13f6:   4391        bics r1, r2
    13f8:   6001        str r1, [r0, #0]
    13fa:   bd10        pop {r4, pc}
    13fc:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
    1400:   4614        mov r4, r2
    1402:   4688        mov r8, r1
    1404:   4607        mov r7, r0
    1406:   f7ff ff75   bl 0x12f4
    140a:   4606        mov r6, r0
    140c:   4638        mov r0, r7
    140e:   f000 fca9   bl 0x1d64
    1412:   4605        mov r5, r0
    1414:   2100        movs r1, #0
    1416:   4638        mov r0, r7
    1418:   f7ff ff87   bl 0x132a
    141c:   42b4        cmp r4, r6
    141e:   d800        bhi.n 0x1422
    1420:   b110        cbz r0, 0x1428
    1422:   2000        movs r0, #0
    1424:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
    1428:   4638        mov r0, r7
    142a:   f7ff ff45   bl 0x12b8
    142e:   4601        mov r1, r0
    1430:   1ce0        adds r0, r4, #3
    1432:   0882        lsrs r2, r0, #2
    1434:   4640        mov r0, r8
    1436:   f000 fc8d   bl 0x1d54
    143a:   60ec        str r4, [r5, #12]
    143c:   2002        movs r0, #2
    143e:   6028        str r0, [r5, #0]
    1440:   4620        mov r0, r4
    1442:   e7ef        b.n 0x1424
    1444:   4902        ldr r1, [pc, #8]    ; (0x1450)
    1446:   684a        ldr r2, [r1, #4]
    1448:   4302        orrs r2, r0
    144a:   604a        str r2, [r1, #4]
    144c:   4770        bx lr
    144e:   0000        movs r0, r0
    1450:   8000        strh r0, [r0, #0]
    1452:   400a        ands r2, r1
    1454:   4603        mov r3, r0
    1456:   2107        movs r1, #7
    1458:   f101 0208   add.w r2, r1, #8
    145c:   fa23 f002   lsr.w r0, r3, r2
    1460:   07c2        lsls r2, r0, #31
    1462:   d001        beq.n 0x1468
    1464:   b248        sxtb r0, r1
    1466:   4770        bx lr
    1468:   1e49        subs r1, r1, #1
    146a:   2900        cmp r1, #0
    146c:   dcf4        bgt.n 0x1458
    146e:   f04f 30ff   mov.w r0, #4294967295    ; 0xffffffff
    1472:   4770        bx lr
    1474:   4802        ldr r0, [pc, #8]    ; (0x1480)
    1476:   6841        ldr r1, [r0, #4]
    1478:   6880        ldr r0, [r0, #8]
    147a:   4008        ands r0, r1
    147c:   4770        bx lr
    147e:   0000        movs r0, r0
    1480:   8000        strh r0, [r0, #0]
    1482:   400a        ands r2, r1
    1484:   4802        ldr r0, [pc, #8]    ; (0x1490)
    1486:   6801        ldr r1, [r0, #0]
    1488:   f041 010c   orr.w r1, r1, #12
    148c:   6001        str r1, [r0, #0]
    148e:   4770        bx lr
    1490:   8000        strh r0, [r0, #0]
    1492:   400a        ands r2, r1
    1494:   4802        ldr r0, [pc, #8]    ; (0x14a0)
    1496:   6801        ldr r1, [r0, #0]
    1498:   f401 6180   and.w r1, r1, #1024    ; 0x400
    149c:   6001        str r1, [r0, #0]
    149e:   4770        bx lr
    14a0:   8000        strh r0, [r0, #0]
    14a2:   400a        ands r2, r1
    14a4:   b510        push {r4, lr}
    14a6:   4604        mov r4, r0
    14a8:   481a        ldr r0, [pc, #104]    ; (0x1514)
    14aa:   6802        ldr r2, [r0, #0]
    14ac:   2a01        cmp r2, #1
    14ae:   d12f        bne.n 0x1510
    14b0:   2200        movs r2, #0
    14b2:   6002        str r2, [r0, #0]
    14b4:   4818        ldr r0, [pc, #96]    ; (0x1518)
    14b6:   6802        ldr r2, [r0, #0]
    14b8:   0653        lsls r3, r2, #25
    14ba:   f04f 32ff   mov.w r2, #4294967295    ; 0xffffffff
    14be:   d50c        bpl.n 0x14da
    14c0:   f240 430c   movw r3, #1036    ; 0x40c
    14c4:   6003        str r3, [r0, #0]
    14c6:   6082        str r2, [r0, #8]
    14c8:   b911        cbnz r1, 0x14d0
    14ca:   2000        movs r0, #0
    14cc:   f7ff f91c   bl 0x708
    14d0:   6820        ldr r0, [r4, #0]
    14d2:   e8bd 4010   ldmia.w sp!, {r4, lr}
    14d6:   f7ff bfb5   b.w 0x1444
    14da:   f640 430c   movw r3, #3084    ; 0xc0c
    14de:   6003        str r3, [r0, #0]
    14e0:   6082        str r2, [r0, #8]
    14e2:   b911        cbnz r1, 0x14ea
    14e4:   2000        movs r0, #0
    14e6:   f7ff f90f   bl 0x708
    14ea:   2000        movs r0, #0
    14ec:   f7ff feac   bl 0x1248
    14f0:   6820        ldr r0, [r4, #0]
    14f2:   f7ff ffa7   bl 0x1444
    14f6:   2000        movs r0, #0
    14f8:   f7ff feb4   bl 0x1264
    14fc:   21c8        movs r1, #200    ; 0xc8
    14fe:   2000        movs r0, #0
    1500:   1c40        adds r0, r0, #1
    1502:   4288        cmp r0, r1
    1504:   d3fc        bcc.n 0x1500
    1506:   e8bd 4010   ldmia.w sp!, {r4, lr}
    150a:   2001        movs r0, #1
    150c:   f7ff beaa   b.w 0x1264
    1510:   bd10        pop {r4, pc}
    1512:   0000        movs r0, r0
    1514:   0000        movs r0, r0
    1516:   2000        movs r0, #0
    1518:   8000        strh r0, [r0, #0]
    151a:   400a        ands r2, r1
    151c:   f241 111d   movw r1, #4381    ; 0x111d
    1520:   6001        str r1, [r0, #0]
    1522:   490a        ldr r1, [pc, #40]    ; (0x154c)
    1524:   6041        str r1, [r0, #4]
    1526:   f240 2112   movw r1, #530    ; 0x212
    152a:   6081        str r1, [r0, #8]
    152c:   4908        ldr r1, [pc, #32]    ; (0x1550)
    152e:   60c1        str r1, [r0, #12]
    1530:   4a08        ldr r2, [pc, #32]    ; (0x1554)
    1532:   2110        movs r1, #16
    1534:   e9c0 1204   strd r1, r2, [r0, #16]
    1538:   6181        str r1, [r0, #24]
    153a:   4907        ldr r1, [pc, #28]    ; (0x1558)
    153c:   61c1        str r1, [r0, #28]
    153e:   2100        movs r1, #0
    1540:   6201        str r1, [r0, #32]
    1542:   4906        ldr r1, [pc, #24]    ; (0x155c)
    1544:   6241        str r1, [r0, #36]    ; 0x24
    1546:   2102        movs r1, #2
    1548:   6281        str r1, [r0, #40]    ; 0x28
    154a:   4770        bx lr
    154c:   0008        movs r0, r1
    154e:   8001        strh r1, [r0, #0]
    1550:   2088        movs r0, #136    ; 0x88
    1552:   9100        str r1, [sp, #0]
    1554:   0090        lsls r0, r2, #2
    1556:   9201        str r2, [sp, #4]
    1558:   00d0        lsls r0, r2, #3
    155a:   9301        str r3, [sp, #4]
    155c:   0110        lsls r0, r2, #4
    155e:   8401        strh r1, [r0, #32]

get_event:
    ; return 0,1,2,3
  0x1560:   b510        push {r4, lr}
    1562:   4c12        ldr r4, [pc, #72]    ; (0x15ac)
    1564:   f894 0032   ldrb.w r0, [r4, #50]    ; 0x32
    1568:   2803        cmp r0, #3
    156a:   d101        bne.n 0x1570
    156c:   f000 fc02   bl 0x1d74
    1570:   490f        ldr r1, [pc, #60]    ; (0x15b0)
    1572:   7908        ldrb r0, [r1, #4]
    1574:   b178        cbz r0, 0x1596
    1576:   2801        cmp r0, #1
    1578:   d009        beq.n 0x158e
    157a:   2802        cmp r0, #2
    157c:   d10f        bne.n 0x159e
    157e:   f894 0032   ldrb.w r0, [r4, #50]    ; 0x32
    1582:   2806        cmp r0, #6
    1584:   d101        bne.n 0x158a
    1586:   f000 f999   bl 0x18bc
    158a:   2002        movs r0, #2         ; return 2
    158c:   bd10        pop {r4, pc}

  0x158e:   2000        movs r0, #0
    1590:   7108        strb r0, [r1, #4]
    1592:   2003        movs r0, #3         ; return 3
    1594:   bd10        pop {r4, pc}

  0x1596:   f894 0032   ldrb.w r0, [r4, #50]    ; 0x32
    159a:   2806        cmp r0, #6
    159c:   d001        beq.n 0x15a2
    159e:   2000        movs r0, #0         ; return 0
    15a0:   bd10        pop {r4, pc}

  0x15a2:   2002        movs r0, #2
    15a4:   7108        strb r0, [r1, #4]
    15a6:   2001        movs r0, #1         ; return 1
    15a8:   bd10        pop {r4, pc}
    15aa:   0000

  0x15ac:   0x20000304
  0x15b0:   0x2000001c

    15b4:   4902        ldr r1, [pc, #8]    ; (0x15c0)
    15b6:   680a        ldr r2, [r1, #0]
    15b8:   6002        str r2, [r0, #0]
    15ba:   6849        ldr r1, [r1, #4]
    15bc:   6041        str r1, [r0, #4]
    15be:   4770        bx lr
    15c0:   a000        add r0, pc, #0    ; (adr r0, 0x15c4)
    15c2:   400a        ands r2, r1
    15c4:   4802        ldr r0, [pc, #8]    ; (0x15d0)
    15c6:   6801        ldr r1, [r0, #0]
    15c8:   f041 0120   orr.w r1, r1, #32
    15cc:   6001        str r1, [r0, #0]
    15ce:   4770        bx lr
    15d0:   8000        strh r0, [r0, #0]
    15d2:   400a        ands r2, r1
    15d4:   4903        ldr r1, [pc, #12]    ; (0x15e4)
    15d6:   680a        ldr r2, [r1, #0]
    15d8:   f442 7280   orr.w r2, r2, #256    ; 0x100
    15dc:   600a        str r2, [r1, #0]
    15de:   6108        str r0, [r1, #16]
    15e0:   4770        bx lr
    15e2:   0000        movs r0, r0
    15e4:   8000        strh r0, [r0, #0]
    15e6:   400a        ands r2, r1

usb_intr:
  0x15e8:   4801        ldr r0, [pc, #4]    ; (0x15f0)
    15ea:   f7ff bd21   b.w 0x1030
    15ee:   0000

    15f0:   0x20000304

watchdog_init:
  0x15f4:   4805        ldr r0, [pc, #20]    ; (0x160c)
    15f6:   6b01        ldr r1, [r0, #48]    ; 0x30
    15f8:   f041 0110   orr.w r1, r1, #16
    15fc:   6301        str r1, [r0, #48]    ; 0x30
    15fe:   4804        ldr r0, [pc, #16]    ; (0x1610)
    1600:   f645 71ff   movw r1, #24575    ; 0x5fff
    1604:   6081        str r1, [r0, #8]
    1606:   4903        ldr r1, [pc, #12]    ; (0x1614)
    1608:   6041        str r1, [r0, #4]
    160a:   4770        bx lr

    160c:   0x40088000  ; CKCU
    1610:   0x40068000  ; WDT
    1614:   0x0001afff

watchdog_reload_timer:
  0x1618:   4902        ldr r1, [pc, #8]    ; (0x1624)
    161a:   4801        ldr r0, [pc, #4]    ; (0x1620)
    161c:   6008        str r0, [r1, #0]
    161e:   4770        bx lr

    1620:   0x5fa00001
    1624:   0x40068000  ; WDT

generate:
    ; r0 = sp
  0x1628:   b570        push {r4, r5, r6, lr}
    162a:   2100        movs r1, #0

    ; write counter over bytes on stack
  0x162c:   f800 1b01   strb.w r1, [r0], #1
    1630:   1c49        adds r1, r1, #1
    1632:   29ff        cmp r1, #255    ; 0xff
    1634:   d9fa        bls.n 0x162c

    1636:   2300        movs r3, #0
    1638:   4d0a        ldr r5, [pc, #40]   ; (0x1664)
    163a:   461a        mov r2, r3          ; j
    163c:   4619        mov r1, r3          ; i
    163e:   f5a0 7080   sub.w r0, r0, #256  ; 0x100

  0x1642:   5cae        ldrb r6, [r5, r2]   ; data byte
    1644:   5c44        ldrb r4, [r0, r1]   ; counter byte
    1646:   1c52        adds r2, r2, #1

    1648:   4423        add r3, r4          ; r3 += r4
    164a:   4433        add r3, r6          ; r3 += r6

    164c:   b2db        uxtb r3, r3
    164e:   b2d2        uxtb r2, r2

    1650:   5cc6        ldrb r6, [r0, r3]
    1652:   5446        strb r6, [r0, r1]   ; [r0 + i] = [r0 + r3]

    1654:   54c4        strb r4, [r0, r3]

    1656:   2a08        cmp r2, #8
    1658:   d300        bcc.n 0x165c
    165a:   2200        movs r2, #0
  0x165c:   1c49        adds r1, r1, #1     ; i++
    165e:   29ff        cmp r1, #255        ; 0xff
    1660:   d9ef        bls.n 0x1642

    1662:   bd70        pop {r4, r5, r6, pc}

  0x1664:   0x1f44

firmware_check:
    ; r0 = 0x3400
    ; r1 =
    ; r2 = 0/1 sum/crc
  0x1668:   e92d 4ff0   stmdb sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
    166c:   4606        mov r6, r0
    166e:   f643 30f8   movw r0, #15352    ; 0x3bf8
    1672:   b0c1        sub sp, #260    ; 0x104
    1674:   6800        ldr r0, [r0, #0]
    1676:   4691        mov r9, r2
    1678:   460d        mov r5, r1
    167a:   f1b0 7f41   cmp.w r0, #50593792    ; 0x3040000
    167e:   d104        bne.n 0x168a

    1680:   f643 30fc   movw r0, #15356    ; 0x3bfc
    1684:   7800        ldrb r0, [r0, #0]
    1686:   2801        cmp r0, #1
    1688:   d003        beq.n 0x1692

  0x168a:   2000        movs r0, #0
  0x168c:   b041        add sp, #260    ; 0x104
    168e:   e8bd 8ff0   ldmia.w sp!, {r4, r5, r6, r7, r8, r9, sl, fp, pc}

  0x1692:   f8df a0a0   ldr.w sl, [pc, #160]    ; 0x1734
    1696:   f04f 0800   mov.w r8, #0
    169a:   f643 3bff   movw fp, #15359    ; 0x3bff
    169e:   f1b9 0f00   cmp.w r9, #0
    16a2:   d03c        beq.n 0x171e

    ; Enable CRC clock
    16a4:   2100        movs r1, #0
    16a6:   f44f 5000   mov.w r0, #8192     ; 0x2000
    16aa:   2301        movs r3, #1
    16ac:   460a        mov r2, r1
    16ae:   f7fe fe0d   bl 0x2cc            ; call ckcu_clocks_enable(0x2000, 0, 0, 1)

    16b2:   f04f 31ff   mov.w r1, #4294967295   ; 0xffffffff
    16b6:   f8ca 1004   str.w r1, [sl, #4]
    16ba:   21e6        movs r1, #230           ; 0xe6
    16bc:   f8ca 1000   str.w r1, [sl]
    16c0:   e02d        b.n 0x171e

  0x16c2:   f89b 0000   ldrb.w r0, [fp]
    16c6:   42a8        cmp r0, r5
    16c8:   d900        bls.n 0x16cc
    16ca:   4628        mov r0, r5
    16cc:   b2c4        uxtb r4, r0
    16ce:   1b2d        subs r5, r5, r4

    16d0:   4668        mov r0, sp
    16d2:   f7ff ffa9   bl 0x1628           ; call generate

    16d6:   2100        movs r1, #0
    16d8:   4608        mov r0, r1
    16da:   e01d        b.n 0x1718

  0x16dc:   1c49        adds r1, r1, #1
    16de:   b2c9        uxtb r1, r1
    16e0:   f81d 2001   ldrb.w r2, [sp, r1]
    16e4:   4410        add r0, r2
    16e6:   b2c0        uxtb r0, r0
    16e8:   f81d c000   ldrb.w ip, [sp, r0]
    16ec:   f80d c001   strb.w ip, [sp, r1]
    16f0:   f80d 2000   strb.w r2, [sp, r0]
    16f4:   4462        add r2, ip
    16f6:   b2d2        uxtb r2, r2
    16f8:   7837        ldrb r7, [r6, #0]
    16fa:   f81d 2002   ldrb.w r2, [sp, r2]
    16fe:   4057        eors r7, r2

    1700:   f1b9 0f00   cmp.w r9, #0
    1704:   d002        beq.n 0x170c

    1706:   f88a 700c   strb.w r7, [sl, #12]
    170a:   e004        b.n 0x1716

  0x170c:   1e4a        subs r2, r1, #1
    170e:   0792        lsls r2, r2, #30
    1710:   0ed2        lsrs r2, r2, #27
    1712:   4097        lsls r7, r2
    1714:   44b8        add r8, r7

  0x1716:   1c76        adds r6, r6, #1
  0x1718:   1e64        subs r4, r4, #1
    171a:   b2e4        uxtb r4, r4
    171c:   d2de        bcs.n 0x16dc        ; loop

  0x171e:   2d00        cmp r5, #0
    1720:   d1cf        bne.n 0x16c2

    1722:   f1b9 0f00   cmp.w r9, #0
    1726:   d002        beq.n 0x172e

    1728:   f8da 0008   ldr.w r0, [sl, #8]
    172c:   e7ae        b.n 0x168c          ; return

  0x172e:   4640        mov r0, r8
    1730:   e7ac        b.n 0x168c          ; return
    1732:   0000

  0x1734:   0x4008a000  ; CRC

    1738:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
    173c:   4c28        ldr r4, [pc, #160]    ; (0x17e0)
    173e:   4d29        ldr r5, [pc, #164]    ; (0x17e4)
    1740:   f8df 80a4   ldr.w r8, [pc, #164]    ; 0x17e8
    1744:   4f29        ldr r7, [pc, #164]    ; (0x17ec)
    1746:   260a        movs r6, #10
    1748:   e9d5 0100   ldrd r0, r1, [r5]
    174c:   6281        str r1, [r0, #40]    ; 0x28
    174e:   1e76        subs r6, r6, #1
    1750:   b2f6        uxtb r6, r6
    1752:   1ee4        subs r4, r4, #3
    1754:   bf00        nop
    1756:   bf00        nop
    1758:   20ff        movs r0, #255    ; 0xff
    175a:   69f9        ldr r1, [r7, #28]
    175c:   0589        lsls r1, r1, #22
    175e:   d400        bmi.n 0x1762
    1760:   20fe        movs r0, #254    ; 0xfe
    1762:   f8d8 201c   ldr.w r2, [r8, #28]
    1766:   4641        mov r1, r8
    1768:   0692        lsls r2, r2, #26
    176a:   d401        bmi.n 0x1770
    176c:   f020 0002   bic.w r0, r0, #2
    1770:   69ca        ldr r2, [r1, #28]
    1772:   0652        lsls r2, r2, #25
    1774:   d401        bmi.n 0x177a
    1776:   f020 0004   bic.w r0, r0, #4
    177a:   69c9        ldr r1, [r1, #28]
    177c:   0609        lsls r1, r1, #24
    177e:   d401        bmi.n 0x1784
    1780:   f020 0008   bic.w r0, r0, #8
    1784:   69f9        ldr r1, [r7, #28]
    1786:   0509        lsls r1, r1, #20
    1788:   d401        bmi.n 0x178e
    178a:   f020 0010   bic.w r0, r0, #16
    178e:   69f9        ldr r1, [r7, #28]
    1790:   0489        lsls r1, r1, #18
    1792:   d401        bmi.n 0x1798
    1794:   f020 0020   bic.w r0, r0, #32
    1798:   69f9        ldr r1, [r7, #28]
    179a:   0449        lsls r1, r1, #17
    179c:   d401        bmi.n 0x17a2
    179e:   f020 0040   bic.w r0, r0, #64    ; 0x40
    17a2:   69f9        ldr r1, [r7, #28]
    17a4:   0409        lsls r1, r1, #16
    17a6:   d401        bmi.n 0x17ac
    17a8:   f020 0080   bic.w r0, r0, #128    ; 0x80
    17ac:   e9d5 1200   ldrd r1, r2, [r5]
    17b0:   624a        str r2, [r1, #36]    ; 0x24
    17b2:   7861        ldrb r1, [r4, #1]
    17b4:   4281        cmp r1, r0
    17b6:   d002        beq.n 0x17be
    17b8:   7060        strb r0, [r4, #1]
    17ba:   2003        movs r0, #3
    17bc:   e005        b.n 0x17ca
    17be:   7820        ldrb r0, [r4, #0]
    17c0:   b120        cbz r0, 0x17cc
    17c2:   2801        cmp r0, #1
    17c4:   d100        bne.n 0x17c8
    17c6:   70a1        strb r1, [r4, #2]
    17c8:   1e40        subs r0, r0, #1
    17ca:   7020        strb r0, [r4, #0]
    17cc:   2e00        cmp r6, #0
    17ce:   d004        beq.n 0x17da
    17d0:   2005        movs r0, #5
    17d2:   f7fe fc96   bl 0x102
    17d6:   3d08        subs r5, #8
    17d8:   e7b6        b.n 0x1748
    17da:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
    17de:   0000        movs r0, r0
    17e0:   00ec        lsls r4, r5, #3
    17e2:   2000        movs r0, #0
    17e4:   206c        movs r0, #108    ; 0x6c
    17e6:   0000        movs r0, r0
    17e8:   0000        movs r0, r0
    17ea:   400b        ands r3, r1
    17ec:   4000        ands r0, r0
    17ee:   400b        ands r3, r1
    17f0:   b5fe        push {r1, r2, r3, r4, r5, r6, r7, lr}
    17f2:   4811        ldr r0, [pc, #68]    ; (0x1838)
    17f4:   6800        ldr r0, [r0, #0]
    17f6:   4911        ldr r1, [pc, #68]    ; (0x183c)
    17f8:   4e11        ldr r6, [pc, #68]    ; (0x1840)
    17fa:   fbb0 f4f1   udiv r4, r0, r1
    17fe:   1e64        subs r4, r4, #1
    1800:   f8ad 4000   strh.w r4, [sp]
    1804:   2500        movs r5, #0
    1806:   f8ad 5002   strh.w r5, [sp, #2]
    180a:   4669        mov r1, sp
    180c:   4630        mov r0, r6
    180e:   f7fe fe4f   bl 0x4b0
    1812:   f88d 5000   strb.w r5, [sp]
    1816:   2007        movs r0, #7
    1818:   f8ad 0002   strh.w r0, [sp, #2]
    181c:   2001        movs r0, #1
    181e:   f88d 0004   strb.w r0, [sp, #4]
    1822:   f88d 5005   strb.w r5, [sp, #5]
    1826:   0860        lsrs r0, r4, #1
    1828:   f8ad 0006   strh.w r0, [sp, #6]
    182c:   4669        mov r1, sp
    182e:   4630        mov r0, r6
    1830:   f7fe fe12   bl 0x458
    1834:   bdfe        pop {r1, r2, r3, r4, r5, r6, r7, pc}
    1836:   0000        movs r0, r0
    1838:   0018        movs r0, r3
    183a:   2000        movs r0, #0
    183c:   ba00        rev r0, r0
    183e:   00db        lsls r3, r3, #3
    1840:   f000 4006   and.w r0, r0, #2248146944    ; 0x86000000
    1844:   b510        push {r4, lr}
    1846:   490a        ldr r1, [pc, #40]    ; (0x1870)
    1848:   f44f 4400   mov.w r4, #32768    ; 0x8000
    184c:   628c        str r4, [r1, #40]    ; 0x28
    184e:   bf00        nop
    1850:   bf00        nop
    1852:   624c        str r4, [r1, #36]    ; 0x24
    1854:   f44f 4280   mov.w r2, #16384    ; 0x4000
    1858:   e004        b.n 0x1864
    185a:   628a        str r2, [r1, #40]    ; 0x28
    185c:   bf00        nop
    185e:   bf00        nop
    1860:   624a        str r2, [r1, #36]    ; 0x24
    1862:   bf00        nop
    1864:   1e40        subs r0, r0, #1
    1866:   b2c0        uxtb r0, r0
    1868:   d2f7        bcs.n 0x185a
    186a:   628c        str r4, [r1, #40]    ; 0x28
    186c:   bd10        pop {r4, pc}
    186e:   0000        movs r0, r0
    1870:   0000        movs r0, r0
    1872:   400b        ands r3, r1
    1874:   b5f0        push {r4, r5, r6, r7, lr}
    1876:   2204        movs r2, #4
    1878:   4b09        ldr r3, [pc, #36]    ; (0x18a0)
    187a:   0314        lsls r4, r2, #12
    187c:   4d09        ldr r5, [pc, #36]    ; (0x18a4)
    187e:   f64f 76ff   movw r6, #65535    ; 0xffff
    1882:   e009        b.n 0x1898
    1884:   bf00        nop
    1886:   62ac        str r4, [r5, #40]    ; 0x28
    1888:   0407        lsls r7, r0, #16
    188a:   d501        bpl.n 0x1890
    188c:   625a        str r2, [r3, #36]    ; 0x24
    188e:   e000        b.n 0x1892
    1890:   629a        str r2, [r3, #40]    ; 0x28
    1892:   626c        str r4, [r5, #36]    ; 0x24
    1894:   ea06 0040   and.w r0, r6, r0, lsl #1
    1898:   1e49        subs r1, r1, #1
    189a:   b2c9        uxtb r1, r1
    189c:   d2f2        bcs.n 0x1884
    189e:   bdf0        pop {r4, r5, r6, r7, pc}
    18a0:   4000        ands r0, r0
    18a2:   400b        ands r3, r1
    18a4:   0000        movs r0, r0
    18a6:   400b        ands r3, r1
    18a8:   2101        movs r1, #1
    18aa:   4081        lsls r1, r0
    18ac:   4802        ldr r0, [pc, #8]    ; (0x18b8)
    18ae:   7942        ldrb r2, [r0, #5]
    18b0:   4311        orrs r1, r2
    18b2:   7141        strb r1, [r0, #5]
    18b4:   4770        bx lr
    18b6:   0000        movs r0, r0
    18b8:   001c        movs r4, r3
    18ba:   2000        movs r0, #0
    18bc:   e92d 41f0   stmdb sp!, {r4, r5, r6, r7, r8, lr}
    18c0:   4833        ldr r0, [pc, #204]    ; (0x1990)
    18c2:   7801        ldrb r1, [r0, #0]
    18c4:   2400        movs r4, #0
    18c6:   f1a0 050a   sub.w r5, r0, #10
    18ca:   2901        cmp r1, #1
    18cc:   d105        bne.n 0x18da
    18ce:   7004        strb r4, [r0, #0]
    18d0:   7c28        ldrb r0, [r5, #16]
    18d2:   f000 0007   and.w r0, r0, #7
    18d6:   f7fe fd8c   bl 0x3f2
    18da:   4e2e        ldr r6, [pc, #184]    ; (0x1994)
    18dc:   4f2e        ldr r7, [pc, #184]    ; (0x1998)
    18de:   7830        ldrb r0, [r6, #0]
    18e0:   b128        cbz r0, 0x18ee
    18e2:   2802        cmp r0, #2
    18e4:   d018        beq.n 0x1918
    18e6:   2804        cmp r0, #4
    18e8:   d001        beq.n 0x18ee
    18ea:   2805        cmp r0, #5
    18ec:   d11d        bne.n 0x192a
    18ee:   7968        ldrb r0, [r5, #5]
    18f0:   06c0        lsls r0, r0, #27
    18f2:   d51a        bpl.n 0x192a
    18f4:   2001        movs r0, #1
    18f6:   7030        strb r0, [r6, #0]
    18f8:   2240        movs r2, #64    ; 0x40
    18fa:   4928        ldr r1, [pc, #160]    ; (0x199c)
    18fc:   2004        movs r0, #4
    18fe:   f7ff fd4d   bl 0x139c
    1902:   4a26        ldr r2, [pc, #152]    ; (0x199c)
    1904:   f1c0 0140   rsb r1, r0, #64    ; 0x40
    1908:   4410        add r0, r2
    190a:   f7fe fbb2   bl 0x72
    190e:   7968        ldrb r0, [r5, #5]
    1910:   f020 0010   bic.w r0, r0, #16
    1914:   7168        strb r0, [r5, #5]
    1916:   e008        b.n 0x192a
    1918:   6d38        ldr r0, [r7, #80]    ; 0x50
    191a:   0780        lsls r0, r0, #30
    191c:   d505        bpl.n 0x192a
    191e:   2240        movs r2, #64    ; 0x40
    1920:   491e        ldr r1, [pc, #120]    ; (0x199c)
    1922:   2003        movs r0, #3
    1924:   f7ff fd6a   bl 0x13fc
    1928:   7034        strb r4, [r6, #0]
    192a:   6ab8        ldr r0, [r7, #40]    ; 0x28
    192c:   0780        lsls r0, r0, #30
    192e:   d517        bpl.n 0x1960
    1930:   7828        ldrb r0, [r5, #0]
    1932:   b108        cbz r0, 0x1938
    1934:   702c        strb r4, [r5, #0]
    1936:   e00d        b.n 0x1954
    1938:   4919        ldr r1, [pc, #100]    ; (0x19a0)
    193a:   6808        ldr r0, [r1, #0]
    193c:   b980        cbnz r0, 0x1960
    193e:   f101 000c   add.w r0, r1, #12
    1942:   6800        ldr r0, [r0, #0]
    1944:   b160        cbz r0, 0x1960
    1946:   f44f 627a   mov.w r2, #4000    ; 0xfa0
    194a:   4350        muls r0, r2
    194c:   10d2        asrs r2, r2, #3
    194e:   fbb0 f0f2   udiv r0, r0, r2
    1952:   6008        str r0, [r1, #0]
    1954:   490e        ldr r1, [pc, #56]    ; (0x1990)
    1956:   2208        movs r2, #8
    1958:   3112        adds r1, #18
    195a:   2001        movs r0, #1
    195c:   f7ff fd4e   bl 0x13fc
    1960:   6bf8        ldr r0, [r7, #60]    ; 0x3c
    1962:   0780        lsls r0, r0, #30
    1964:   d512        bpl.n 0x198c
    1966:   78a8        ldrb r0, [r5, #2]
    1968:   b120        cbz r0, 0x1974
    196a:   4909        ldr r1, [pc, #36]    ; (0x1990)
    196c:   2205        movs r2, #5
    196e:   70ac        strb r4, [r5, #2]
    1970:   310a        adds r1, #10
    1972:   e006        b.n 0x1982
    1974:   7868        ldrb r0, [r5, #1]
    1976:   2800        cmp r0, #0
    1978:   d008        beq.n 0x198c
    197a:   4905        ldr r1, [pc, #20]    ; (0x1990)
    197c:   2202        movs r2, #2
    197e:   706c        strb r4, [r5, #1]
    1980:   1e89        subs r1, r1, #2
    1982:   e8bd 41f0   ldmia.w sp!, {r4, r5, r6, r7, r8, lr}
    1986:   2002        movs r0, #2
    1988:   f7ff bd38   b.w 0x13fc
    198c:   e8bd 81f0   ldmia.w sp!, {r4, r5, r6, r7, r8, pc}
    1990:   0026        movs r6, r4
    1992:   2000        movs r0, #0
    1994:   0004        movs r4, r0
    1996:   2000        movs r0, #0
    1998:   8000        strh r0, [r0, #0]
    199a:   400a        ands r2, r1
    199c:   0084        lsls r4, r0, #2
    199e:   2000        movs r0, #0
    19a0:   02ec        lsls r4, r5, #11
    19a2:   2000        movs r0, #0
    19a4:   b5f0        push {r4, r5, r6, r7, lr}
    19a6:   8801        ldrh r1, [r0, #0]
    19a8:   f44f 7680   mov.w r6, #256    ; 0x100
    19ac:   f640 1521   movw r5, #2337    ; 0x921
    19b0:   0077        lsls r7, r6, #1
    19b2:   2201        movs r2, #1
    19b4:   4c32        ldr r4, [pc, #200]    ; (0x1a80)
    19b6:   f6a1 1321   subw r3, r1, #2337    ; 0x921
    19ba:   42a9        cmp r1, r5
    19bc:   d037        beq.n 0x1a2e
    19be:   dc0d        bgt.n 0x19dc
    19c0:   f513 61f0   adds.w r1, r3, #1920    ; 0x780
    19c4:   d013        beq.n 0x19ee
    19c6:   42b1        cmp r1, r6
    19c8:   d02b        beq.n 0x1a22
    19ca:   42b9        cmp r1, r7
    19cc:   d140        bne.n 0x1a50
    19ce:   8881        ldrh r1, [r0, #4]
    19d0:   2900        cmp r1, #0
    19d2:   d13d        bne.n 0x1a50
    19d4:   492b        ldr r1, [pc, #172]    ; (0x1a84)
    19d6:   e9c0 1207   strd r1, r2, [r0, #28]
    19da:   e04e        b.n 0x1a7a
    19dc:   2500        movs r5, #0
    19de:   42b3        cmp r3, r6
    19e0:   d038        beq.n 0x1a54
    19e2:   42bb        cmp r3, r7
    19e4:   d134        bne.n 0x1a50
    19e6:   8883        ldrh r3, [r0, #4]
    19e8:   7881        ldrb r1, [r0, #2]
    19ea:   b393        cbz r3, 0x1a52
    19ec:   e044        b.n 0x1a78
    19ee:   78c5        ldrb r5, [r0, #3]
    19f0:   7883        ldrb r3, [r0, #2]
    19f2:   88c4        ldrh r4, [r0, #6]
    19f4:   8881        ldrh r1, [r0, #4]
    19f6:   2d01        cmp r5, #1
    19f8:   d12a        bne.n 0x1a50
    19fa:   b151        cbz r1, 0x1a12
    19fc:   2901        cmp r1, #1
    19fe:   d027        beq.n 0x1a50
    1a00:   2902        cmp r1, #2
    1a02:   d125        bne.n 0x1a50
    1a04:   2b01        cmp r3, #1
    1a06:   d007        beq.n 0x1a18
    1a08:   2b02        cmp r3, #2
    1a0a:   d121        bne.n 0x1a50
    1a0c:   491d        ldr r1, [pc, #116]    ; (0x1a84)
    1a0e:   3111        adds r1, #17
    1a10:   e004        b.n 0x1a1c
    1a12:   491c        ldr r1, [pc, #112]    ; (0x1a84)
    1a14:   3119        adds r1, #25
    1a16:   e001        b.n 0x1a1c
    1a18:   491a        ldr r1, [pc, #104]    ; (0x1a84)
    1a1a:   1d49        adds r1, r1, #5
    1a1c:   e9c0 1407   strd r1, r4, [r0, #28]
    1a20:   e02b        b.n 0x1a7a
    1a22:   8881        ldrh r1, [r0, #4]
    1a24:   2900        cmp r1, #0
    1a26:   d113        bne.n 0x1a50
    1a28:   e9c0 4207   strd r4, r2, [r0, #28]
    1a2c:   e025        b.n 0x1a7a
    1a2e:   78c2        ldrb r2, [r0, #3]
    1a30:   88c3        ldrh r3, [r0, #6]
    1a32:   8881        ldrh r1, [r0, #4]
    1a34:   6203        str r3, [r0, #32]
    1a36:   2a02        cmp r2, #2
    1a38:   d10a        bne.n 0x1a50
    1a3a:   2900        cmp r1, #0
    1a3c:   d108        bne.n 0x1a50
    1a3e:   4a11        ldr r2, [pc, #68]    ; (0x1a84)
    1a40:   320d        adds r2, #13
    1a42:   61c2        str r2, [r0, #28]
    1a44:   4a10        ldr r2, [pc, #64]    ; (0x1a88)
    1a46:   e9c0 210a   strd r2, r1, [r0, #40]    ; 0x28
    1a4a:   2102        movs r1, #2
    1a4c:   f880 1024   strb.w r1, [r0, #36]    ; 0x24
    1a50:   bdf0        pop {r4, r5, r6, r7, pc}
    1a52:   e00e        b.n 0x1a72
    1a54:   8883        ldrh r3, [r0, #4]
    1a56:   78c1        ldrb r1, [r0, #3]
    1a58:   2b00        cmp r3, #0
    1a5a:   d1f9        bne.n 0x1a50
    1a5c:   f44f 637a   mov.w r3, #4000    ; 0xfa0
    1a60:   6021        str r1, [r4, #0]
    1a62:   4359        muls r1, r3
    1a64:   10db        asrs r3, r3, #3
    1a66:   fbb1 f1f3   udiv r1, r1, r3
    1a6a:   4b05        ldr r3, [pc, #20]    ; (0x1a80)
    1a6c:   3b0c        subs r3, #12
    1a6e:   6019        str r1, [r3, #0]
    1a70:   e002        b.n 0x1a78
    1a72:   4b04        ldr r3, [pc, #16]    ; (0x1a84)
    1a74:   1edb        subs r3, r3, #3
    1a76:   70d9        strb r1, [r3, #3]
    1a78:   6205        str r5, [r0, #32]
    1a7a:   f880 2024   strb.w r2, [r0, #36]    ; 0x24
    1a7e:   e7e7        b.n 0x1a50
    1a80:   02f8        lsls r0, r7, #11
    1a82:   2000        movs r0, #0
    1a84:   001f        movs r7, r3
    1a86:   2000        movs r0, #0
    1a88:   1a8d        subs r5, r1, r2
    1a8a:   0000        movs r0, r0
    1a8c:   4a01        ldr r2, [pc, #4]    ; (0x1a94)
    1a8e:   2101        movs r1, #1
    1a90:   5411        strb r1, [r2, r0]
    1a92:   4770        bx lr
    1a94:   0026        movs r6, r4
    1a96:   2000        movs r0, #0
    1a98:   78c2        ldrb r2, [r0, #3]
    1a9a:   8881        ldrh r1, [r0, #4]
    1a9c:   2301        movs r3, #1
    1a9e:   2a21        cmp r2, #33    ; 0x21
    1aa0:   d007        beq.n 0x1ab2
    1aa2:   2a22        cmp r2, #34    ; 0x22
    1aa4:   d121        bne.n 0x1aea
    1aa6:   b1a9        cbz r1, 0x1ad4
    1aa8:   2901        cmp r1, #1
    1aaa:   d017        beq.n 0x1adc
    1aac:   2902        cmp r1, #2
    1aae:   d11a        bne.n 0x1ae6
    1ab0:   e01c        b.n 0x1aec
    1ab2:   b121        cbz r1, 0x1abe
    1ab4:   2901        cmp r1, #1
    1ab6:   d005        beq.n 0x1ac4
    1ab8:   2902        cmp r1, #2
    1aba:   d106        bne.n 0x1aca
    1abc:   e007        b.n 0x1ace
    1abe:   68c1        ldr r1, [r0, #12]
    1ac0:   3109        adds r1, #9
    1ac2:   e001        b.n 0x1ac8
    1ac4:   68c1        ldr r1, [r0, #12]
    1ac6:   3122        adds r1, #34    ; 0x22
    1ac8:   61c1        str r1, [r0, #28]
    1aca:   2109        movs r1, #9
    1acc:   e00a        b.n 0x1ae4
    1ace:   68c1        ldr r1, [r0, #12]
    1ad0:   3142        adds r1, #66    ; 0x42
    1ad2:   e7f9        b.n 0x1ac8
    1ad4:   4908        ldr r1, [pc, #32]    ; (0x1af8)
    1ad6:   61c1        str r1, [r0, #28]
    1ad8:   2140        movs r1, #64    ; 0x40
    1ada:   e003        b.n 0x1ae4
    1adc:   4906        ldr r1, [pc, #24]    ; (0x1af8)
    1ade:   398c        subs r1, #140    ; 0x8c
    1ae0:   61c1        str r1, [r0, #28]
    1ae2:   2122        movs r1, #34    ; 0x22
    1ae4:   6201        str r1, [r0, #32]
    1ae6:   f880 3024   strb.w r3, [r0, #36]    ; 0x24
    1aea:   4770        bx lr
    1aec:   4902        ldr r1, [pc, #8]    ; (0x1af8)
    1aee:   3968        subs r1, #104    ; 0x68
    1af0:   61c1        str r1, [r0, #28]
    1af2:   2165        movs r1, #101    ; 0x65
    1af4:   e7f6        b.n 0x1ae4
    1af6:   0000        movs r0, r0
    1af8:   2148        movs r1, #72    ; 0x48
    1afa:   0000        movs r0, r0
    1afc:   b570        push {r4, r5, r6, lr}
    1afe:   4604        mov r4, r0
    1b00:   2000        movs r0, #0
    1b02:   f7ff fbf7   bl 0x12f4
    1b06:   4605        mov r5, r0
    1b08:   6a20        ldr r0, [r4, #32]
    1b0a:   1c41        adds r1, r0, #1
    1b0c:   d016        beq.n 0x1b3c
    1b0e:   f894 1024   ldrb.w r1, [r4, #36]    ; 0x24
    1b12:   2901        cmp r1, #1
    1b14:   d112        bne.n 0x1b3c
    1b16:   42a8        cmp r0, r5
    1b18:   d302        bcc.n 0x1b20
    1b1a:   1b40        subs r0, r0, r5
    1b1c:   6220        str r0, [r4, #32]
    1b1e:   e005        b.n 0x1b2c
    1b20:   4605        mov r5, r0
    1b22:   2000        movs r0, #0
    1b24:   6220        str r0, [r4, #32]
    1b26:   2002        movs r0, #2
    1b28:   f884 0024   strb.w r0, [r4, #36]    ; 0x24
    1b2c:   462a        mov r2, r5
    1b2e:   2000        movs r0, #0
    1b30:   69e1        ldr r1, [r4, #28]
    1b32:   f7ff fc63   bl 0x13fc
    1b36:   69e0        ldr r0, [r4, #28]
    1b38:   4428        add r0, r5
    1b3a:   61e0        str r0, [r4, #28]
    1b3c:   bd70        pop {r4, r5, r6, pc}
    1b3e:   0000        movs r0, r0
    1b40:   b510        push {r4, lr}
    1b42:   4604        mov r4, r0
    1b44:   2000        movs r0, #0
    1b46:   f884 0024   strb.w r0, [r4, #36]    ; 0x24
    1b4a:   6220        str r0, [r4, #32]
    1b4c:   7820        ldrb r0, [r4, #0]
    1b4e:   f010 0060   ands.w r0, r0, #96    ; 0x60
    1b52:   d002        beq.n 0x1b5a
    1b54:   2820        cmp r0, #32
    1b56:   d109        bne.n 0x1b6c
    1b58:   e003        b.n 0x1b62
    1b5a:   4620        mov r0, r4
    1b5c:   f000 f840   bl 0x1be0
    1b60:   e004        b.n 0x1b6c
    1b62:   4810        ldr r0, [pc, #64]    ; (0x1ba4)
    1b64:   6941        ldr r1, [r0, #20]
    1b66:   b109        cbz r1, 0x1b6c
    1b68:   4620        mov r0, r4
    1b6a:   4788        blx r1
    1b6c:   f894 0024   ldrb.w r0, [r4, #36]    ; 0x24
    1b70:   2801        cmp r0, #1
    1b72:   d006        beq.n 0x1b82
    1b74:   2802        cmp r0, #2
    1b76:   d00e        beq.n 0x1b96
    1b78:   e8bd 4010   ldmia.w sp!, {r4, lr}
    1b7c:   2000        movs r0, #0
    1b7e:   f7ff bc2d   b.w 0x13dc
    1b82:   88e0        ldrh r0, [r4, #6]
    1b84:   6a21        ldr r1, [r4, #32]
    1b86:   4281        cmp r1, r0
    1b88:   dd00        ble.n 0x1b8c
    1b8a:   6220        str r0, [r4, #32]
    1b8c:   4620        mov r0, r4
    1b8e:   e8bd 4010   ldmia.w sp!, {r4, lr}
    1b92:   f7ff bfb3   b.w 0x1afc
    1b96:   2200        movs r2, #0
    1b98:   e8bd 4010   ldmia.w sp!, {r4, lr}
    1b9c:   4611        mov r1, r2
    1b9e:   4610        mov r0, r2
    1ba0:   f7ff bc2c   b.w 0x13fc
    1ba4:   2214        movs r2, #20
    1ba6:   0000        movs r0, r0
    1ba8:   b510        push {r4, lr}
    1baa:   4604        mov r4, r0
    1bac:   2000        movs r0, #0
    1bae:   7660        strb r0, [r4, #25]
    1bb0:   b149        cbz r1, 0x1bc6
    1bb2:   2901        cmp r1, #1
    1bb4:   d009        beq.n 0x1bca
    1bb6:   2902        cmp r1, #2
    1bb8:   d110        bne.n 0x1bdc
    1bba:   7920        ldrb r0, [r4, #4]
    1bbc:   f000 000f   and.w r0, r0, #15
    1bc0:   f7ff fb9f   bl 0x1302
    1bc4:   e001        b.n 0x1bca
    1bc6:   f894 0034   ldrb.w r0, [r4, #52]    ; 0x34
    1bca:   7620        strb r0, [r4, #24]
    1bcc:   f104 0018   add.w r0, r4, #24
    1bd0:   61e0        str r0, [r4, #28]
    1bd2:   2002        movs r0, #2
    1bd4:   6220        str r0, [r4, #32]
    1bd6:   2001        movs r0, #1
    1bd8:   f884 0024   strb.w r0, [r4, #36]    ; 0x24
    1bdc:   bd10        pop {r4, pc}
    1bde:   0000        movs r0, r0
    1be0:   b570        push {r4, r5, r6, lr}
    1be2:   4604        mov r4, r0
    1be4:   8800        ldrh r0, [r0, #0]
    1be6:   2501        movs r5, #1
    1be8:   f5b0 6fa0   cmp.w r0, #1280    ; 0x500
    1bec:   d04f        beq.n 0x1c8e
    1bee:   dc20        bgt.n 0x1c32
    1bf0:   f5b0 7f80   cmp.w r0, #256    ; 0x100
    1bf4:   d044        beq.n 0x1c80
    1bf6:   dc0b        bgt.n 0x1c10
    1bf8:   2880        cmp r0, #128    ; 0x80
    1bfa:   d03d        beq.n 0x1c78
    1bfc:   2881        cmp r0, #129    ; 0x81
    1bfe:   d03d        beq.n 0x1c7c
    1c00:   2882        cmp r0, #130    ; 0x82
    1c02:   d166        bne.n 0x1cd2
    1c04:   2102        movs r1, #2
    1c06:   4620        mov r0, r4
    1c08:   e8bd 4070   ldmia.w sp!, {r4, r5, r6, lr}
    1c0c:   f7ff bfcc   b.w 0x1ba8
    1c10:   f5b0 7f81   cmp.w r0, #258    ; 0x102
    1c14:   d036        beq.n 0x1c84
    1c16:   f5b0 7f40   cmp.w r0, #768    ; 0x300
    1c1a:   d035        beq.n 0x1c88
    1c1c:   f5a0 7040   sub.w r0, r0, #768    ; 0x300
    1c20:   3802        subs r0, #2
    1c22:   d156        bne.n 0x1cd2
    1c24:   2201        movs r2, #1
    1c26:   2102        movs r1, #2
    1c28:   4620        mov r0, r4
    1c2a:   e8bd 4070   ldmia.w sp!, {r4, r5, r6, lr}
    1c2e:   f000 b86b   b.w 0x1d08
    1c32:   4933        ldr r1, [pc, #204]    ; (0x1d00)
    1c34:   f5b0 6f10   cmp.w r0, #2304    ; 0x900
    1c38:   d04e        beq.n 0x1cd8
    1c3a:   dc0f        bgt.n 0x1c5c
    1c3c:   f5b0 6fd0   cmp.w r0, #1664    ; 0x680
    1c40:   d02c        beq.n 0x1c9c
    1c42:   f5a0 60c0   sub.w r0, r0, #1536    ; 0x600
    1c46:   3881        subs r0, #129    ; 0x81
    1c48:   d044        beq.n 0x1cd4
    1c4a:   f5a0 7080   sub.w r0, r0, #256    ; 0x100
    1c4e:   38ff        subs r0, #255    ; 0xff
    1c50:   d13f        bne.n 0x1cd2
    1c52:   f104 0030   add.w r0, r4, #48    ; 0x30
    1c56:   e9c4 0507   strd r0, r5, [r4, #28]
    1c5a:   e038        b.n 0x1cce
    1c5c:   f5a0 6020   sub.w r0, r0, #2560    ; 0xa00
    1c60:   3881        subs r0, #129    ; 0x81
    1c62:   d04a        beq.n 0x1cfa
    1c64:   2880        cmp r0, #128    ; 0x80
    1c66:   d134        bne.n 0x1cd2
    1c68:   68c8        ldr r0, [r1, #12]
    1c6a:   2800        cmp r0, #0
    1c6c:   d031        beq.n 0x1cd2
    1c6e:   4601        mov r1, r0
    1c70:   4620        mov r0, r4
    1c72:   e8bd 4070   ldmia.w sp!, {r4, r5, r6, lr}
    1c76:   4708        bx r1
    1c78:   2100        movs r1, #0
    1c7a:   e7c4        b.n 0x1c06
    1c7c:   2101        movs r1, #1
    1c7e:   e7c2        b.n 0x1c06
    1c80:   2200        movs r2, #0
    1c82:   e002        b.n 0x1c8a
    1c84:   2200        movs r2, #0
    1c86:   e7ce        b.n 0x1c26
    1c88:   2201        movs r2, #1
    1c8a:   2100        movs r1, #0
    1c8c:   e7cc        b.n 0x1c28
    1c8e:   78a0        ldrb r0, [r4, #2]
    1c90:   f7ff fca0   bl 0x15d4
    1c94:   f884 5024   strb.w r5, [r4, #36]    ; 0x24
    1c98:   2005        movs r0, #5
    1c9a:   e02b        b.n 0x1cf4
    1c9c:   78e0        ldrb r0, [r4, #3]
    1c9e:   2801        cmp r0, #1
    1ca0:   d00f        beq.n 0x1cc2
    1ca2:   2802        cmp r0, #2
    1ca4:   d00f        beq.n 0x1cc6
    1ca6:   2803        cmp r0, #3
    1ca8:   d113        bne.n 0x1cd2
    1caa:   78a0        ldrb r0, [r4, #2]
    1cac:   6961        ldr r1, [r4, #20]
    1cae:   4281        cmp r1, r0
    1cb0:   d90f        bls.n 0x1cd2
    1cb2:   6921        ldr r1, [r4, #16]
    1cb4:   f851 0020   ldr.w r0, [r1, r0, lsl #2]
    1cb8:   2800        cmp r0, #0
    1cba:   d00a        beq.n 0x1cd2
    1cbc:   61e0        str r0, [r4, #28]
    1cbe:   7800        ldrb r0, [r0, #0]
    1cc0:   e004        b.n 0x1ccc
    1cc2:   68a0        ldr r0, [r4, #8]
    1cc4:   e7fa        b.n 0x1cbc
    1cc6:   68e0        ldr r0, [r4, #12]
    1cc8:   61e0        str r0, [r4, #28]
    1cca:   8840        ldrh r0, [r0, #2]
    1ccc:   6220        str r0, [r4, #32]
    1cce:   f884 5024   strb.w r5, [r4, #36]    ; 0x24
    1cd2:   bd70        pop {r4, r5, r6, pc}
    1cd4:   6888        ldr r0, [r1, #8]
    1cd6:   e7c8        b.n 0x1c6a
    1cd8:   78a0        ldrb r0, [r4, #2]
    1cda:   f884 0030   strb.w r0, [r4, #48]    ; 0x30
    1cde:   f884 5024   strb.w r5, [r4, #36]    ; 0x24
    1ce2:   2501        movs r5, #1
    1ce4:   4907        ldr r1, [pc, #28]    ; (0x1d04)
    1ce6:   b268        sxtb r0, r5
    1ce8:   f7ff fb28   bl 0x133c
    1cec:   1c6d        adds r5, r5, #1
    1cee:   2d08        cmp r5, #8
    1cf0:   d3f8        bcc.n 0x1ce4
    1cf2:   2006        movs r0, #6
    1cf4:   f884 0032   strb.w r0, [r4, #50]    ; 0x32
    1cf8:   bd70        pop {r4, r5, r6, pc}
    1cfa:   6908        ldr r0, [r1, #16]
    1cfc:   e7b5        b.n 0x1c6a
    1cfe:   0000        movs r0, r0
    1d00:   2214        movs r2, #20
    1d02:   0000        movs r0, r0
    1d04:   0040        lsls r0, r0, #1
    1d06:   2000        movs r0, #0
    1d08:   b570        push {r4, r5, r6, lr}
    1d0a:   4604        mov r4, r0
    1d0c:   2601        movs r6, #1
    1d0e:   b161        cbz r1, 0x1d2a
    1d10:   2902        cmp r1, #2
    1d12:   d109        bne.n 0x1d28
    1d14:   7920        ldrb r0, [r4, #4]
    1d16:   f010 050f   ands.w r5, r0, #15
    1d1a:   d003        beq.n 0x1d24
    1d1c:   b182        cbz r2, 0x1d40
    1d1e:   4628        mov r0, r5
    1d20:   f7ff fb62   bl 0x13e8
    1d24:   f884 6024   strb.w r6, [r4, #36]    ; 0x24
    1d28:   bd70        pop {r4, r5, r6, pc}
    1d2a:   78a0        ldrb r0, [r4, #2]
    1d2c:   2801        cmp r0, #1
    1d2e:   d1fb        bne.n 0x1d28
    1d30:   f814 0f34   ldrb.w r0, [r4, #52]!
    1d34:   f362 0041   bfi r0, r2, #1, #1
    1d38:   f804 0910   strb.w r0, [r4], #-16
    1d3c:   7026        strb r6, [r4, #0]
    1d3e:   bd70        pop {r4, r5, r6, pc}
    1d40:   6ba0        ldr r0, [r4, #56]    ; 0x38
    1d42:   2800        cmp r0, #0
    1d44:   d1ee        bne.n 0x1d24
    1d46:   4628        mov r0, r5
    1d48:   f7ff faa8   bl 0x129c
    1d4c:   4628        mov r0, r5
    1d4e:   f7ff fa9d   bl 0x128c
    1d52:   e7e7        b.n 0x1d24
    1d54:   1e52        subs r2, r2, #1
    1d56:   d404        bmi.n 0x1d62
    1d58:   f850 3022   ldr.w r3, [r0, r2, lsl #2]
    1d5c:   f841 3022   str.w r3, [r1, r2, lsl #2]
    1d60:   e7f8        b.n 0x1d54
    1d62:   4770        bx lr
    1d64:   4902        ldr r1, [pc, #8]    ; (0x1d70)
    1d66:   eb00 0080   add.w r0, r0, r0, lsl #2
    1d6a:   eb01 0080   add.w r0, r1, r0, lsl #2
    1d6e:   4770        bx lr
    1d70:   8014        strh r4, [r2, #0]
    1d72:   400a        ands r2, r1
    1d74:   e92d 47f0   stmdb sp!, {r4, r5, r6, r7, r8, r9, sl, lr}
    1d78:   2700        movs r7, #0
    1d7a:   f44f 4100   mov.w r1, #32768    ; 0x8000
    1d7e:   463a        mov r2, r7
    1d80:   468a        mov sl, r1
    1d82:   2301        movs r3, #1
    1d84:   4610        mov r0, r2
    1d86:   f7fe faa1   bl 0x2cc                ; call ckcu_clocks_enable
    1d8a:   4824        ldr r0, [pc, #144]    ; (0x1e1c)
    1d8c:   f7ff f94a   bl 0x1024
    1d90:   4d23        ldr r5, [pc, #140]    ; (0x1e20)
    1d92:   4604        mov r4, r0
    1d94:   f64e 26e0   movw r6, #60128    ; 0xeae0
    1d98:   2801        cmp r0, #1
    1d9a:   d106        bne.n 0x1daa
    1d9c:   6d68        ldr r0, [r5, #84]    ; 0x54
    1d9e:   4330        orrs r0, r6
    1da0:   6568        str r0, [r5, #84]    ; 0x54
    1da2:   65ae        str r6, [r5, #88]    ; 0x58
    1da4:   6d28        ldr r0, [r5, #80]    ; 0x50
    1da6:   4330        orrs r0, r6
    1da8:   6528        str r0, [r5, #80]    ; 0x50
    1daa:   f8df 8070   ldr.w r8, [pc, #112]    ; 0x1e1c
    1dae:   f898 0032   ldrb.w r0, [r8, #50]    ; 0x32
    1db2:   2803        cmp r0, #3
    1db4:   d11e        bne.n 0x1df4
    1db6:   f8df 906c   ldr.w r9, [pc, #108]    ; 0x1e24
    1dba:   f8d9 0000   ldr.w r0, [r9]
    1dbe:   f010 0fc0   tst.w r0, #192    ; 0xc0
    1dc2:   d017        beq.n 0x1df4
    1dc4:   2001        movs r0, #1
    1dc6:   f7fe fbc9   bl 0x55c
    1dca:   4917        ldr r1, [pc, #92]    ; (0x1e28)
    1dcc:   710f        strb r7, [r1, #4]
    1dce:   f898 0032   ldrb.w r0, [r8, #50]    ; 0x32
    1dd2:   2803        cmp r0, #3
    1dd4:   d10e        bne.n 0x1df4
    1dd6:   f8d9 0000   ldr.w r0, [r9]
    1dda:   f010 0fc0   tst.w r0, #192    ; 0xc0
    1dde:   d009        beq.n 0x1df4
    1de0:   f7ff fc1a   bl 0x1618
    1de4:   f44f 707a   mov.w r0, #1000    ; 0x3e8
    1de8:   f7fe f98b   bl 0x102
    1dec:   65ae        str r6, [r5, #88]    ; 0x58
    1dee:   2000        movs r0, #0
    1df0:   f7fe fc8a   bl 0x708
    1df4:   6da8        ldr r0, [r5, #88]    ; 0x58
    1df6:   4230        tst r0, r6
    1df8:   d008        beq.n 0x1e0c
    1dfa:   2c01        cmp r4, #1
    1dfc:   d106        bne.n 0x1e0c
    1dfe:   4807        ldr r0, [pc, #28]    ; (0x1e1c)
    1e00:   f7ff f9d6   bl 0x11b0
    1e04:   2801        cmp r0, #1
    1e06:   d101        bne.n 0x1e0c
    1e08:   f7ff f9da   bl 0x11c0
    1e0c:   463a        mov r2, r7
    1e0e:   4651        mov r1, sl
    1e10:   e8bd 47f0   ldmia.w sp!, {r4, r5, r6, r7, r8, r9, sl, lr}
    1e14:   2300        movs r3, #0
    1e16:   4610        mov r0, r2
    1e18:   f7fe ba58   b.w 0x2cc                ; call ckcu_clocks_enable
    1e1c:   0304        lsls r4, r0, #12
    1e1e:   2000        movs r0, #0
    1e20:   4000        ands r0, r0
    1e22:   4002        ands r2, r0
    1e24:   8000        strh r0, [r0, #0]
    1e26:   400a        ands r2, r1
    1e28:   001c        movs r4, r3
    1e2a:   2000        movs r0, #0
    1e2c:   e002        b.n 0x1e34
    1e2e:   c808        ldmia r0!, {r3}
    1e30:   1f12        subs r2, r2, #4
    1e32:   c108        stmia r1!, {r3}
    1e34:   2a00        cmp r2, #0
    1e36:   d1fa        bne.n 0x1e2e
    1e38:   4770        bx lr
    1e3a:   2000        movs r0, #0
    1e3c:   e001        b.n 0x1e42
    1e3e:   c101        stmia r1!, {r0}
    1e40:   1f12        subs r2, r2, #4
    1e42:   2a00        cmp r2, #0
    1e44:   d1fb        bne.n 0x1e3e
    1e46:   4770        bx lr

check_fw_sp_pc:
  0x1e48:   f44f 5050   mov.w r0, #13312            ; 0x3400
    1e4c:   6801        ldr r1, [r0, #0]
    1e4e:   f1a1 5100   sub.w r1, r1, #536870912    ; 0x20000000
    1e52:   f5b1 4f80   cmp.w r1, #16384            ; 0x4000
    1e56:   d824        bhi.n 0x1ea2                ; error if stack max > 0x4000

    1e58:   1d01        adds r1, r0, #4
    1e5a:   6809        ldr r1, [r1, #0]
    1e5c:   f5a1 5150   sub.w r1, r1, #13312        ; 0x3400
    1e60:   f5b1 4f48   cmp.w r1, #51200            ; 0xc800
    1e64:   d21d        bcs.n 0x1ea2                ; error if reset out of range

    1e66:   f643 31f8   movw r1, #15352             ; 0x3bf8
    1e6a:   6809        ldr r1, [r1, #0]
    1e6c:   f1b1 7f41   cmp.w r1, #50593792         ; 0x3040000
    1e70:   d117        bne.n 0x1ea2                ; error if [0x3bf8] != 0x03040000

    1e72:   f44f 5140   mov.w r1, #12288            ; 0x3000
    1e76:   f8d1 10b0   ldr.w r1, [r1, #176]        ; 0xb0
    1e7a:   f3c1 0211   ubfx r2, r1, #0, #18
    1e7e:   f5a2 43b4   sub.w r3, r2, #23040        ; 0x5a00
    1e82:   3ba5        subs r3, #165               ; 0xa5
    1e84:   d10d        bne.n 0x1ea2

    1e86:   0c8a        lsrs r2, r1, #18
    1e88:   2a0e        cmp r2, #14
    1e8a:   d80a        bhi.n 0x1ea2

    1e8c:   f243 0178   movw r1, #12408     ; 0x3078
    1e90:   e003        b.n 0x1e9a

  0x1e92:   680b        ldr r3, [r1, #0]    ; read word
    1e94:   1c5b        adds r3, r3, #1
    1e96:   d004        beq.n 0x1ea2        ; error if word == -1
    1e98:   1d09        adds r1, r1, #4

  0x1e9a:   1e52        subs r2, r2, #1
    1e9c:   d2f9        bcs.n 0x1e92        ; loop

    1e9e:   f7fe b8c7   b.w 0x30            ; jump load_jump_fw(0x3400)

  0x1ea2:   4770        bx lr

main:
  0x1ea4:   4824        ldr r0, [pc, #144]    ; (0x1f38)
    1ea6:   6803        ldr r3, [r0, #0]
    1ea8:   4a24        ldr r2, [pc, #144]    ; (0x1f3c) reset key
    1eaa:   1d51        adds r1, r2, #5
    ; Check last sram word for reset key
    1eac:   4293        cmp r3, r2
    1eae:   d302        bcc.n 0x1eb6

    1eb0:   6803        ldr r3, [r0, #0]
    1eb2:   428b        cmp r3, r1
    1eb4:   d901        bls.n 0x1eba

  0x1eb6:   6002        str r2, [r0, #0]
    1eb8:   e005        b.n 0x1ec6

  0x1eba:   6802        ldr r2, [r0, #0]
    1ebc:   428a        cmp r2, r1
    1ebe:   d202        bcs.n 0x1ec6
    1ec0:   6802        ldr r2, [r0, #0]
    1ec2:   1c52        adds r2, r2, #1
    1ec4:   e7f7        b.n 0x1eb6

  0x1ec6:   6800        ldr r0, [r0, #0]
    1ec8:   4288        cmp r0, r1
    1eca:   d001        beq.n 0x1ed0

    1ecc:   f7ff ffbc   bl 0x1e48           ; call check_fw_sp_pc()

  0x1ed0:   f7fe fb8c   bl 0x5ec
    1ed4:   f7fe f99e   bl 0x214
    1ed8:   f7fe fe6c   bl 0xbb4
    1edc:   f7fe fbf8   bl 0x6d0
    1ee0:   f7fe fef8   bl 0xcd4
    1ee4:   f7fe fb70   bl 0x5c8
    1ee8:   2001        movs r0, #1
    1eea:   f7fe fb37   bl 0x55c
    1eee:   f7ff f975   bl 0x11dc
    1ef2:   4c13        ldr r4, [pc, #76]    ; (0x1f40)

    ; main loop
  0x1ef4:   f7ff fb34   bl 0x1560           ; call get_event

    1ef8:   2801        cmp r0, #1
    1efa:   d007        beq.n 0x1f0c
    1efc:   2802        cmp r0, #2
    1efe:   d00f        beq.n 0x1f20
    1f00:   2803        cmp r0, #3
    1f02:   d116        bne.n 0x1f32

    ; if r0 == 3
    1f04:   2001        movs r0, #1
    1f06:   f7fe fb29   bl 0x55c
    1f0a:   e012        b.n 0x1f32

    ; if r0 == 1
  0x1f0c:   2000        movs r0, #0
    1f0e:   f7fe fb25   bl 0x55c
    1f12:   f7fe ff79   bl 0xe08
    1f16:   f7fe fbf2   bl 0x6fe
    1f1a:   2000        movs r0, #0
    1f1c:   f7fe fe1e   bl 0xb5c

    ; if r0 == 2
  0x1f20:   f7fe fc76   bl 0x810            ; call handle_frame()
    1f24:   f7fe fde8   bl 0xaf8
    1f28:   7820        ldrb r0, [r4, #0]
    1f2a:   b910        cbnz r0, 0x1f32
    1f2c:   2001        movs r0, #1
    1f2e:   f7fe fc33   bl 0x798

    ; else
  0x1f32:   f7ff fb71   bl 0x1618
    1f36:   e7dd        b.n 0x1ef4

  0x1f38:   0x20003ffc  ; last sram word
  0x1f3c:   0x55aafaf0  ; reset key
  0x1f40:   0x20000004

.data:

  0x1f44:   01 23 45 67
    1f48:   89 ab cd ef

    1f4c:   08 09
    1f4e:   0a 0b
    1f50:   0c 0d
    1f52:   0e 0f
    1f54:   10 11
    1f56:   12 13
    1f58:   14 15
    1f5a:   16 17
    1f5c:   18 19
    1f5e:   1a 1b
    1f60:   1c 1d
    1f62:   1e 1f
    1f64:   20 21
    1f66:   22 23
    1f68:   24 25
    1f6a:   26 27
    1f6c:   28 29
    1f6e:   2a 2b
    1f70:   2c 2d
    1f72:   2e 2f
    1f74:   30 31
    1f76:   32 33
    1f78:   34 35
    1f7a:   36 37
    1f7c:   38 39
    1f7e:   3a 3b
    1f80:   3c 3d
    1f82:   3e 3f
    1f84:   29 1e
    1f86:   1f 20
    1f88:   21 22
    1f8a:   23 24
    1f8c:   2b 14
    1f8e:   1a 08
    1f90:   15 17
    1f92:   1c 18
    1f94:   39 04
    1f96:   16 07
    1f98:   09 0a
    1f9a:   0b 0d
    1f9c:   e1 1d
    1f9e:   1b 06
    1fa0:   19 05
    1fa2:   11 10
    1fa4:   e0 e3
    1fa6:   e2 25
    1fa8:   26 27
    1faa:   2d 2a
    1fac:   64 00
    1fae:   2e 0c
    1fb0:   12 13
    1fb2:   2f 31
    1fb4:   00 00
    1fb6:   30 0e
    1fb8:   0f 33
    1fba:   34 28
    1fbc:   00 00
    1fbe:   2c 36
    1fc0:   37 38
    1fc2:   e5 35
    1fc4:   00 00
    1fc6:   00 e6
    1fc8:   e7 65
    1fca:   00 e4
    1fcc:   c0 c1
    1fce:   c2 c3
    1fd0:   00 00
    1fd2:   00 00

gpio_map_3:
  0x1fd4:   00 40 0b 40     0x400b4000  ; GPIO C
    1fd8:   00 02 00 00     0x200       ; pin 9

    1fdc:   00 00 0b 40     0x400b0000  ; GPIO A
    1fe0:   20 00 00 00     0x20        ; pin 5

    1fe4:   00 00 0b 40     0x400b0000  ; GPIO A
    1fe8:   40 00 00 00     0x40        ; pin 6

    1fec:   00 00 0b 40     0x400b0000  ; GPIO A
    1ff0:   80 00 00 00     0x80        ; pin 7

    1ff4:   00 40 0b 40     0x400b4000  ; GPIO C
    1ff8:   00 08 00 00     0x800       ; pin 12

    1ffc:   00 40 0b 40     0x400b4000  ; GPIO C
    2000:   00 20 00 00     0x2000      ; pin 13

    2004:   00 40 0b 40     0x400b4000  ; GPIO C
    2008:   00 40 00 00     0x4000      ; pin 14

    200c:   00 40 0b 40     0x400b4000  ; GPIO C
    2010:   00 80 00 00     0x8000      ; pin 15

  0x2014:   02 09 00 05
    2018:   00 06 00 07
    201c:   02 0b 02 0d
    2020:   02 0e 02 0f

gpio_map_2:
  0x2024:   00 40 0b 40     0x400b4000  ; GPIO C
    2028:   10 00 00 00     0x10        ; pin 4

    202c:   00 20 0b 40     0x400b2000  ; GPIO B
    2030:   40 00 00 00     0x40        ; pin 6

    2034:   00 60 0b 40     0x400b6000  ; GPIO D
    2038:   01 00 00 00     0x1         ; pin 0

    203c:   00 20 0b 40     0x400b2000  ; GPIO B
    2040:   00 08 00 00     0x800       ; pin 11

    2044:   00 00 0b 40     0x400b0000  ; GPIO A
    2048:   00 08 00 00     0x800       ; pin 11

    204c:   00 00 0b 40     0x400b0000  ; GPIO A
    2050:   01 00 00 00     0x1         ; pin 0

    2054:   00 00 0b 40     0x400b0000  ; GPIO A
    2058:   02 00 00 00     0x2         ; pin 1

    205c:   00 00 0b 40     0x400b0000  ; GPIO A
    2060:   04 00 00 00     0x4         ; pin 2

    2064:   00 00 0b 40     0x400b0000  ; GPIO A
    2068:   08 00 00 00     0x8         ; pin 3

    206c:   00 00 0b 40     0x400b0000  ; GPIO A
    2070:   10 00 00 00     0x10        ; pin 4

gpio_map_1:
  0x2074:   00 40 0b 40     0x400b4000  ; GPIO C
    2078:   00 01 00 00     0x100       ; pin 8

    207c:   00 40 0b 40     0x400b4000  ; GPIO C
    2080:   80 00 00 00     0x80        ; pin 7

    2084:   00 20 0b 40     0x400b2000  ; GPIO B
    2088:   20 00 00 00     0x20        ; pin 5

    208c:   00 20 0b 40     0x400b2000  ; GPIO B
    2090:   10 00 00 00     0x10        ; pin 4

    2094:   00 20 0b 40     0x400b2000  ; GPIO B
    2098:   08 00 00 00     0x8         ; pin 3

    209c:   00 20 0b 40     0x400b2000  ; GPIO B
    20a0:   04 00 00 00     0x4         ; pin 2

    20a4:   00 40 0b 40     0x400b4000  ; GPIO C
    20a8:   40 00 00 00     0x40        ; pin 6

    20ac:   00 40 0b 40     0x400b4000  ; GPIO C
    20b0:   20 00 00 00     0x20        ; pin 5

  0x20b4:   34 04 00 00
    20b8:   f8 21 00 00

usb_report1_desc:
  0x20bc:
    ; 0x06, 0x00, 0xFF,  // Usage Page (Vendor Defined 0xFF00)
    ; 0x09, 0x01,        // Usage (0x01)
    ; 0xA1, 0x01,        // Collection (Application)
    ; 0x09, 0x02,        //   Usage (0x02)
    ; 0x15, 0x00,        //   Logical Minimum (0)
    ; 0x26, 0xFF, 0x00,  //   Logical Maximum (255)
    ; 0x75, 0x08,        //   Report Size (8)
    ; 0x95, 0x40,        //   Report Count (64)
    ; 0x81, 0x02,        //   Input (Data,Var,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0x09, 0x03,        //   Usage (0x03)
    ; 0x15, 0x00,        //   Logical Minimum (0)
    ; 0x26, 0xFF, 0x00,  //   Logical Maximum (255)
    ; 0x75, 0x08,        //   Report Size (8)
    ; 0x95, 0x40,        //   Report Count (64)
    ; 0x91, 0x02,        //   Output (Data,Var,Abs,No Wrap,Linear,Preferred State,No Null Position,Non-volatile)
    ; 0xC0,              // End Collection

    20de:   00 00

usb_report2_desc:
  0x20ec:
    ; 0x05, 0x01,        // Usage Page (Generic Desktop Ctrls)
    ; 0x09, 0x80,        // Usage (Sys Control)
    ; 0xA1, 0x01,        // Collection (Application)
    ; 0x85, 0x01,        //   Report ID (1)
    ; 0x19, 0x81,        //   Usage Minimum (Sys Power Down)
    ; 0x29, 0x83,        //   Usage Maximum (Sys Wake Up)
    ; 0x15, 0x00,        //   Logical Minimum (0)
    ; 0x25, 0x01,        //   Logical Maximum (1)
    ; 0x95, 0x03,        //   Report Count (3)
    ; 0x75, 0x01,        //   Report Size (1)
    ; 0x81, 0x02,        //   Input (Data,Var,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0x95, 0x01,        //   Report Count (1)
    ; 0x75, 0x05,        //   Report Size (5)
    ; 0x81, 0x01,        //   Input (Const,Array,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0xC0,              // End Collection
    ; 0x05, 0x0C,        // Usage Page (Consumer)
    ; 0x09, 0x01,        // Usage (Consumer Control)
    ; 0xA1, 0x01,        // Collection (Application)
    ; 0x85, 0x02,        //   Report ID (2)
    ; 0x15, 0x00,        //   Logical Minimum (0)
    ; 0x25, 0x01,        //   Logical Maximum (1)
    ; 0x95, 0x12,        //   Report Count (18)
    ; 0x75, 0x01,        //   Report Size (1)
    ; 0x0A, 0x83, 0x01,  //   Usage (AL Consumer Control Configuration)
    ; 0x0A, 0x8A, 0x01,  //   Usage (AL Email Reader)
    ; 0x0A, 0x92, 0x01,  //   Usage (AL Calculator)
    ; 0x0A, 0x94, 0x01,  //   Usage (AL Local Machine Browser)
    ; 0x09, 0xCD,        //   Usage (Play/Pause)
    ; 0x09, 0xB7,        //   Usage (Stop)
    ; 0x09, 0xB6,        //   Usage (Scan Previous Track)
    ; 0x09, 0xB5,        //   Usage (Scan Next Track)
    ; 0x09, 0xE2,        //   Usage (Mute)
    ; 0x09, 0xEA,        //   Usage (Volume Decrement)
    ; 0x09, 0xE9,        //   Usage (Volume Increment)
    ; 0x0A, 0x21, 0x02,  //   Usage (AC Search)
    ; 0x0A, 0x23, 0x02,  //   Usage (AC Home)
    ; 0x0A, 0x24, 0x02,  //   Usage (AC Back)
    ; 0x0A, 0x25, 0x02,  //   Usage (AC Forward)
    ; 0x0A, 0x26, 0x02,  //   Usage (AC Stop)
    ; 0x0A, 0x27, 0x02,  //   Usage (AC Refresh)
    ; 0x0A, 0x2A, 0x02,  //   Usage (AC Bookmarks)
    ; 0x81, 0x02,        //   Input (Data,Var,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0x95, 0x01,        //   Report Count (1)
    ; 0x75, 0x0E,        //   Report Size (14)
    ; 0x81, 0x01,        //   Input (Const,Array,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0xC0,              // End Collection

    2145:   00
    2146:   00 00

usb_report0_desc:
  0x2148:
    ; 0x05, 0x01,        // Usage Page (Generic Desktop Ctrls)
    ; 0x09, 0x06,        // Usage (Keyboard)
    ; 0xA1, 0x01,        // Collection (Application)
    ; 0x05, 0x07,        //   Usage Page (Kbrd/Keypad)
    ; 0x19, 0xE0,        //   Usage Minimum (0xE0)
    ; 0x29, 0xE7,        //   Usage Maximum (0xE7)
    ; 0x15, 0x00,        //   Logical Minimum (0)
    ; 0x25, 0x01,        //   Logical Maximum (1)
    ; 0x75, 0x01,        //   Report Size (1)
    ; 0x95, 0x08,        //   Report Count (8)
    ; 0x81, 0x02,        //   Input (Data,Var,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0x95, 0x01,        //   Report Count (1)
    ; 0x75, 0x08,        //   Report Size (8)
    ; 0x81, 0x03,        //   Input (Const,Var,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0x95, 0x03,        //   Report Count (3)
    ; 0x75, 0x01,        //   Report Size (1)
    ; 0x05, 0x08,        //   Usage Page (LEDs)
    ; 0x19, 0x01,        //   Usage Minimum (Num Lock)
    ; 0x29, 0x03,        //   Usage Maximum (Scroll Lock)
    ; 0x91, 0x02,        //   Output (Data,Var,Abs,No Wrap,Linear,Preferred State,No Null Position,Non-volatile)
    ; 0x95, 0x01,        //   Report Count (1)
    ; 0x75, 0x05,        //   Report Size (5)
    ; 0x91, 0x03,        //   Output (Const,Var,Abs,No Wrap,Linear,Preferred State,No Null Position,Non-volatile)
    ; 0x95, 0x06,        //   Report Count (6)
    ; 0x75, 0x08,        //   Report Size (8)
    ; 0x15, 0x00,        //   Logical Minimum (0)
    ; 0x26, 0xA4, 0x00,  //   Logical Maximum (164)
    ; 0x05, 0x07,        //   Usage Page (Kbrd/Keypad)
    ; 0x19, 0x00,        //   Usage Minimum (0x00)
    ; 0x29, 0xA4,        //   Usage Maximum (0xA4)
    ; 0x81, 0x00,        //   Input (Data,Array,Abs,No Wrap,Linear,Preferred State,No Null Position)
    ; 0xC0,              // End Collection

usb_descriptors:
  0x2188:
    ; 0x09,        // bLength
    ; 0x02,        // bDescriptorType (Configuration)
    ; 0x5B, 0x00,  // wTotalLength 91
    ; 0x03,        // bNumInterfaces 3
    ; 0x01,        // bConfigurationValue
    ; 0x00,        // iConfiguration (String Index)
    ; 0xA0,        // bmAttributes Remote Wakeup
    ; 0x32,        // bMaxPower 100mA

    ; 0x09,        // bLength
    ; 0x04,        // bDescriptorType (Interface)
    ; 0x00,        // bInterfaceNumber 0
    ; 0x00,        // bAlternateSetting
    ; 0x01,        // bNumEndpoints 1
    ; 0x03,        // bInterfaceClass
    ; 0x01,        // bInterfaceSubClass
    ; 0x01,        // bInterfaceProtocol
    ; 0x00,        // iInterface (String Index)

    ; 0x09,        // bLength
    ; 0x21,        // bDescriptorType (HID)
    ; 0x11, 0x01,  // bcdHID 1.11
    ; 0x00,        // bCountryCode
    ; 0x01,        // bNumDescriptors
    ; 0x22,        // bDescriptorType[0] (HID)
    ; 0x40, 0x00,  // wDescriptorLength[0] 64

    ; 0x07,        // bLength
    ; 0x05,        // bDescriptorType (Endpoint)
    ; 0x81,        // bEndpointAddress (IN/D2H)
    ; 0x03,        // bmAttributes (Interrupt)
    ; 0x08, 0x00,  // wMaxPacketSize 8
    ; 0x01,        // bInterval 1 (unit depends on device speed)

    ; 0x09,        // bLength
    ; 0x04,        // bDescriptorType (Interface)
    ; 0x01,        // bInterfaceNumber 1
    ; 0x00,        // bAlternateSetting
    ; 0x02,        // bNumEndpoints 2
    ; 0x03,        // bInterfaceClass
    ; 0x00,        // bInterfaceSubClass
    ; 0x00,        // bInterfaceProtocol
    ; 0x00,        // iInterface (String Index)

    ; 0x09,        // bLength
    ; 0x21,        // bDescriptorType (HID)
    ; 0x11, 0x01,  // bcdHID 1.11
    ; 0x00,        // bCountryCode
    ; 0x01,        // bNumDescriptors
    ; 0x22,        // bDescriptorType[0] (HID)
    ; 0x22, 0x00,  // wDescriptorLength[0] 34

    ; 0x07,        // bLength
    ; 0x05,        // bDescriptorType (Endpoint)
    ; 0x83,        // bEndpointAddress (IN/D2H)
    ; 0x03,        // bmAttributes (Interrupt)
    ; 0x40, 0x00,  // wMaxPacketSize 64
    ; 0x01,        // bInterval 1 (unit depends on device speed)

    ; 0x07,        // bLength
    ; 0x05,        // bDescriptorType (Endpoint)
    ; 0x04,        // bEndpointAddress (OUT/H2D)
    ; 0x03,        // bmAttributes (Interrupt)
    ; 0x40, 0x00,  // wMaxPacketSize 64
    ; 0x01,        // bInterval 1 (unit depends on device speed)

    ; 0x09,        // bLength
    ; 0x04,        // bDescriptorType (Interface)
    ; 0x02,        // bInterfaceNumber 2
    ; 0x00,        // bAlternateSetting
    ; 0x01,        // bNumEndpoints 1
    ; 0x03,        // bInterfaceClass
    ; 0x00,        // bInterfaceSubClass
    ; 0x00,        // bInterfaceProtocol
    ; 0x00,        // iInterface (String Index)

    ; 0x09,        // bLength
    ; 0x21,        // bDescriptorType (HID)
    ; 0x11, 0x01,  // bcdHID 1.11
    ; 0x00,        // bCountryCode
    ; 0x01,        // bNumDescriptors
    ; 0x22,        // bDescriptorType[0] (HID)
    ; 0x65, 0x00,  // wDescriptorLength[0] 101

    ; 0x07,        // bLength
    ; 0x05,        // bDescriptorType (Endpoint)
    ; 0x82,        // bEndpointAddress (IN/D2H)
    ; 0x03,        // bmAttributes (Interrupt)
    ; 0x40, 0x00,  // wMaxPacketSize 64
    ; 0x01,        // bInterval 1 (unit depends on device speed)

    ; 0x00,        // bLength
    ; 0x12,        // bLength
    ; 0x01,        // bDescriptorType (Device)
    ; 0x10, 0x01,  // bcdUSB 1.10
    ; 0x00,        // bDeviceClass (Use class information in the Interface Descriptors)
    ; 0x00,        // bDeviceSubClass
    ; 0x00,        // bDeviceProtocol
    ; 0x40,        // bMaxPacketSize0 64
    ; 0xD9, 0x04,  // idVendor 0x04D9
    ; 0x67, 0x11,  // idProduct 0x1167
    ; 0x03, 0x11,  // bcdDevice 28.03
    ; 0x00,        // iManufacturer (String Index)
    ; 0x01,        // iProduct (String Index)
    ; 0x00,        // iSerialNumber (String Index)
    ; 0x01,        // bNumConfigurations 1

    21f6:   00 00

    21f8:   18 03
    21fa:   55 00
    21fc:   53 00
    21fe:   42 00
    2200:   2d 00
    2202:   48 00
    2204:   49 00
    2206:   44 00
    2208:   20 00
    220a:   49 00
    220c:   41 00
    220e:   50 00
    2210:   00 00
    2212:   00 00
    2214:   05 10
    2216:   00 00
    2218:   00 00
    221a:   00 00
    221c:   99 1a
    221e:   00 00
    2220:   00 00
    2222:   00 00
    2224:   00 00
    2226:   00 00
    2228:   a5 19
    222a:   00 00
    222c:   a9 18
    222e:   00 00
    2230:   50 22
    2232:   00 00
    2234:   00 00
    2236:   00 20
    2238:   40 00
    223a:   00 00
    223c:   2c 1e
    223e:   00 00
    2240:   90 22
    2242:   00 00
    2244:   40 00
    2246:   00 20
    2248:   00 07
    224a:   00 00
    224c:   3a 1e
    224e:   00 00
    2250:   01 00
    2252:   00 00
    2254:   00 00
    2256:   00 00
    2258:   00 30
    225a:   00 00
    225c:   00 00
    225e:   00 00
    2260:   ff 00
    2262:   00 00
    2264:   ac 20
    2266:   00 00
    2268:   00 a2
    226a:   4a 04
    226c:   00 00
    226e:   00 00
    2270:   00 00
    2272:   00 00
    2274:   00 00
    2276:   00 00
    2278:   00 00
    227a:   00 00
    227c:   00 00
    227e:   00 00
    2280:   00 00
    2282:   00 00
    2284:   00 00
    2286:   00 00
    2288:   00 00
    228a:   00 00
    228c:   00 00
    228e:   00 00
